<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type='text/xsl' href='STIG_unclass.xsl'?>
<Benchmark
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:cpe="http://cpe.mitre.org/language/2.0"
	xmlns:xhtml="http://www.w3.org/1999/xhtml"
	xmlns:dsig="http://www.w3.org/2000/09/xmldsig#" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.1 http://nvd.nist.gov/schema/xccdf-1.1.4.xsd http://cpe.mitre.org/dictionary/2.0 http://cpe.mitre.org/files/cpe-dictionary_2.1.xsd" id="VMW_Photon_OS_3.0_STIG_Readiness_Guide" xml:lang="en"
	xmlns="http://checklists.nist.gov/xccdf/1.1">
	<status date="2021-07-20">draft</status>
	<title>VMware Photon OS 3.0 STIG Readiness Guide</title>
	<description>This project represents VMware's effort to document our compliance against the SRG requirements and nothing more. A published STIG is our eventual goal, in most cases, but this content should not be viewed to be "as good as a STIG". A DISA published STIG includes technical validation, review of requirement fulfillment, accuracy and style, risk acceptance and is digitally signed by the RME and posted on a .mil. This SRG content is intended to provided value to our partners while the STIGs are in process. Except for products that have published STIGs already, there is no explicit or implied DISA approval of the provided content.</description>
	<notice id="terms-of-use" xml:lang="en"></notice>
	<front-matter xml:lang="en"></front-matter>
	<rear-matter xml:lang="en"></rear-matter>
	<reference href="https://github.com/vmware/dod-compliance-and-automation">
		<dc:publisher>VMware</dc:publisher>
		<dc:source>https://github.com/vmware/dod-compliance-and-automation</dc:source>
	</reference>
	<plain-text id="release-info">Release: 2 Benchmark Date: 20 Jul 2021</plain-text>
	<plain-text id="generator">3.2.2.36079</plain-text>
	<plain-text id="conventionsVersion">1.10.0</plain-text>
	<version>1</version>
  <Group id="PHTN-30-000001">
    <title>SRG-OS-000004-GPOS-00004</title>
    <Rule id="r_PHTN-30-000001" severity="medium">
      <version>PHTN-30-000001</version>
      <title>The Photon operating system must audit all account creations.</title>
      <description>&lt;VulnDiscussion&gt;Once an attacker establishes access to a system, the attacker often
attempts to create a persistent method of reestablishing access. One way to
accomplish this is for the attacker to create an account. Auditing account
creation actions provides logging that can be used for forensic purposes.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000018</ident>
      <fixtext>Navigate to and open:

    /etc/audit/rules.d/audit.STIG.rules

    Add or update the following lines:

    -w /usr/sbin/useradd -p x -k useradd
    -w /usr/sbin/groupadd -p x -k groupadd

    At the command line, execute the following command to load the new audit
rules:

    # /sbin/augenrules --load

    Note: An older audit.STIG.rules may exist if the file exists and references 
    older "GEN" SRG IDs. This file can be removed and replaced as necessary 
    with an updated one.</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # auditctl -l | grep -E "(useradd|groupadd)"

    Expected result:

    -w /usr/sbin/useradd -p x -k useradd
    -w /usr/sbin/groupadd -p x -k groupadd

    If either useradd or groupadd are not listed with a permissions filter of
at least 'x', this is a finding.

    Note: This check depends on the auditd service to be in a running state for 
    accurate results. Enabling the auditd service is done in control PHTN-30-000013.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000002">
    <title>SRG-OS-000021-GPOS-00005</title>
    <Rule id="r_PHTN-30-000002" severity="medium">
      <version>PHTN-30-000002</version>
      <title>The Photon operating system must automatically lock an account when three unsuccessful logon attempts occur.</title>
      <description>&lt;VulnDiscussion&gt;By limiting the number of failed logon attempts, the risk of
unauthorized system access via user password guessing, otherwise known as
brute-force attacks, is reduced. Limits are imposed by locking the account.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000044</ident>
      <fixtext>Navigate to and open:

    /etc/pam.d/system-auth

    Remove any existing "pam_tally2.so" line and add the following line after
the pam_unix.so statement:

    auth required pam_tally2.so deny=3 onerr=fail
audit even_deny_root unlock_time=900 root_unlock_time=300

    Navigate to and open:

    /etc/pam.d/system-account

    Remove any existing "pam_tally2.so" line and add the following line after
the pam_unix.so statement:

    account required pam_tally2.so deny=3
onerr=fail audit even_deny_root unlock_time=900 root_unlock_time=300</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command(s):

    # grep pam_tally2 /etc/pam.d/system-auth

    Expected result:

    auth required pam_tally2.so deny=3 onerr=fail
audit even_deny_root unlock_time=900 root_unlock_time=300

    # grep pam_tally2 /etc/pam.d/system-account

    Expected result:

    account required pam_tally2.so deny=3
onerr=fail audit even_deny_root unlock_time=900 root_unlock_time=300

    If the output does not list the pam_tally2 options as configured in the
expected results, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000003">
    <title>SRG-OS-000023-GPOS-00006</title>
    <Rule id="r_PHTN-30-000003" severity="medium">
      <version>PHTN-30-000003</version>
      <title>The Photon operating system must display the Standard Mandatory DoD Notice and Consent Banner before granting SSH access.</title>
      <description>&lt;VulnDiscussion&gt;Display of a standardized and approved use notification before
granting access to the operating system ensures privacy and security
notification verbiage used is consistent with applicable federal laws,
Executive Orders, directives, policies, regulations, standards, and guidance.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000048</ident>
      <fixtext>Navigate to and open:

    /etc/ssh/sshd_config

    Ensure that the "Banner" line is uncommented and set to the following:

    Banner /etc/issue

    Navigate to and open:

    /etc/issue

    Ensure that the file contains the Standard Mandatory DoD Notice and Consent
Banner.

    "You are accessing a U.S. Government (USG) Information System (IS) that is
provided for USG-authorized use only. By using this IS (which includes any
device attached to this IS), you consent to the following conditions:
    -The USG routinely intercepts and monitors communications on this IS for
purposes including, but not limited to, penetration testing, COMSEC monitoring,
network operations and defense, personnel misconduct (PM), law enforcement
(LE), and counterintelligence (CI) investigations.
    -At any time, the USG may inspect and seize data stored on this IS.
    -Communications using, or data stored on, this IS are not private, are
subject to routine monitoring, interception, and search, and may be disclosed
or used for any USG authorized purpose.
    -This IS includes security measures (e.g., authentication and access
controls) to protect USG interests--not for your personal benefit or privacy.
    -Notwithstanding the above, using this IS does not constitute consent to
PM, LE or CI investigative searching or monitoring of the content of privileged
communications, or work product, related to personal representation or services
by attorneys, psychotherapists, or clergy, and their assistants. Such
communications and work product are private and confidential. See User
Agreement for details."

    At the command line, execute the following command:

    # systemctl restart sshd.service</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # sshd -T|&amp;grep -i Banner

    Expected result:

    banner /etc/issue

    If the output does not match the expected result, this is a finding.

    Next, open /etc/issue with a text editor.

    If the file does not contain the Standard Mandatory DoD Notice and Consent
Banner, this is a finding.

    Standard Mandatory DoD Notice and Consent Banner:

    "You are accessing a U.S. Government (USG) Information System (IS) that is
provided for USG-authorized use only. By using this IS (which includes any
device attached to this IS), you consent to the following conditions:
    -The USG routinely intercepts and monitors communications on this IS for
purposes including, but not limited to, penetration testing, COMSEC monitoring,
network operations and defense, personnel misconduct (PM), law enforcement
(LE), and counterintelligence (CI) investigations.
    -At any time, the USG may inspect and seize data stored on this IS.
    -Communications using, or data stored on, this IS are not private, are
subject to routine monitoring, interception, and search, and may be disclosed
or used for any USG authorized purpose.
    -This IS includes security measures (e.g., authentication and access
controls) to protect USG interests--not for your personal benefit or privacy.
    -Notwithstanding the above, using this IS does not constitute consent to
PM, LE or CI investigative searching or monitoring of the content of privileged
communications, or work product, related to personal representation or services
by attorneys, psychotherapists, or clergy, and their assistants. Such
communications and work product are private and confidential. See User
Agreement for details."</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000004">
    <title>SRG-OS-000027-GPOS-00008</title>
    <Rule id="r_PHTN-30-000004" severity="medium">
      <version>PHTN-30-000004</version>
      <title>The Photon operating system must limit the number of concurrent sessions to 10 for all accounts and/or account types.</title>
      <description>&lt;VulnDiscussion&gt;Operating system management includes the ability to control the number
of users and user sessions that utilize an operating system. Limiting the
number of allowed users and sessions per user is helpful in reducing the risks
related to denial-of-service attacks.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000054</ident>
      <fixtext>At the command line, execute the following command:

# echo '* hard maxlogins 10' &gt;&gt; /etc/security/limits.conf</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

#  grep "^[^#].*maxlogins.*" /etc/security/limits.conf

Expected result:

* hard maxlogins 10

If the output does not match the expected result, this is a finding.

Note: The expected result may be repeated multiple times.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000005">
    <title>SRG-OS-000029-GPOS-00010</title>
    <Rule id="r_PHTN-30-000005" severity="medium">
      <version>PHTN-30-000005</version>
      <title>The Photon operating system must set a session inactivity timeout of 15 minutes or less.</title>
      <description>&lt;VulnDiscussion&gt;A session timeout is an action taken when a session goes idle for any
reason. Rather than relying on the user to manually disconnect their session
prior to going idle, the Photon operating system must be able to identify when
a session has idled and take action to terminate the session.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000057</ident>
      <fixtext>Navigate to and open:

/etc/profile.d/tmout.sh

Set its content to the following:

TMOUT=900
readonly TMOUT
export TMOUT
mesg n 2&gt;/dev/null</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # cat /etc/profile.d/tmout.sh

    Expected result:

    TMOUT=900
    readonly TMOUT
    export TMOUT
    mesg n 2&gt;/dev/null

    If the file "tmout.sh" does not exist or the output does not look like
the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000006">
    <title>SRG-OS-000032-GPOS-00013</title>
    <Rule id="r_PHTN-30-000006" severity="medium">
      <version>PHTN-30-000006</version>
      <title>The Photon operating system must have the sshd SyslogFacility set to "authpriv".</title>
      <description>&lt;VulnDiscussion&gt;Automated monitoring of remote access sessions allows organizations to
detect cyberattacks and ensure ongoing compliance with remote access policies
by auditing connection activities.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000067</ident>
      <fixtext>Navigate to and open:

    /etc/ssh/sshd_config

    Ensure that the "SyslogFacility" line is uncommented and set to the
following:

    SyslogFacility AUTHPRIV

    At the command line, execute the following command:

    # systemctl restart sshd.service</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # sshd -T|&amp;grep -i SyslogFacility

    Expected result:

    syslogfacility AUTHPRIV

    If there is no output or if the output does not match expected result, this
is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000007">
    <title>SRG-OS-000032-GPOS-00013</title>
    <Rule id="r_PHTN-30-000007" severity="medium">
      <version>PHTN-30-000007</version>
      <title>The Photon operating system must have sshd authentication logging enabled.</title>
      <description>&lt;VulnDiscussion&gt;Automated monitoring of remote access sessions allows organizations to
detect cyberattacks and ensure ongoing compliance with remote access policies
by auditing connection activities.

    Shipping sshd authentication events to syslog allows organizations to use
their log aggregators to correlate forensic activities among multiple systems.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000067</ident>
      <fixtext>Navigate to and open:

/etc/rsyslog.conf

Add the following line:

authpriv.*   /var/log/auth.log

Note: The path can be substituted for another suitable log destination.

At the command line, execute the following command:

# systemctl restart rsyslog.service</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# grep "^authpriv" /etc/rsyslog.conf

Expected result should be similar to the following:

authpriv.*   /var/log/auth.log

If authpriv is not configured to be logged, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000008">
    <title>SRG-OS-000032-GPOS-00013</title>
    <Rule id="r_PHTN-30-000008" severity="medium">
      <version>PHTN-30-000008</version>
      <title>The Photon operating system must have the sshd LogLevel set to "INFO".</title>
      <description>&lt;VulnDiscussion&gt;Automated monitoring of remote access sessions allows organizations to
detect cyberattacks and ensure ongoing compliance with remote access policies
by auditing connection activities.

    The INFO LogLevel is required, at least, to ensure the capturing of failed
login events.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000067</ident>
      <fixtext>Navigate to and open:

/etc/ssh/sshd_config

Ensure that the "LogLevel" line is uncommented and set to the following:

LogLevel INFO

At the command line, execute the following command:

# systemctl restart sshd.service</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# sshd -T|&amp;grep -i LogLevel

Expected result:

 LogLevel INFO

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000009">
    <title>SRG-OS-000033-GPOS-00014</title>
    <Rule id="r_PHTN-30-000009" severity="high">
      <version>PHTN-30-000009</version>
      <title>The Photon operating system must configure sshd to use approved encryption algorithms.</title>
      <description>&lt;VulnDiscussion&gt;Without confidentiality protection mechanisms, unauthorized
individuals may gain access to sensitive information via a remote access
session.

    OpenSSH on the Photon operating system is compiled with a FIPS validated
cryptographic module. The "FipsMode" setting controls whether this module is
initialized and used in FIPS 140-2 mode.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000068</ident>
      <fixtext>Navigate to and open:

/etc/ssh/sshd_config

Ensure that the "FipsMode" line is uncommented and set to the following:

FipsMode yes

At the command line, execute the following command:

# systemctl restart sshd.service</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# sshd -T|&amp;grep -i FipsMode

Expected result:

FipsMode yes

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000010">
    <title>SRG-OS-000037-GPOS-00015</title>
    <Rule id="r_PHTN-30-000010" severity="medium">
      <version>PHTN-30-000010</version>
      <title>The Photon operating system must configure auditd to log to disk.</title>
      <description>&lt;VulnDiscussion&gt;Without establishing what type of events occurred, it would be
difficult to establish, correlate, and investigate the events leading up to an
outage or attack.

    Audit record content must be shipped to a central location, but it must
also be logged locally.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000130</ident>
      <fixtext>Navigate to and open:

/etc/audit/auditd.conf

Ensure that the "write_logs" line is uncommented and set to the following:

write_logs = yes

At the command line, execute the following command:

# killproc auditd -TERM
# systemctl start auditd</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# grep "^write_logs" /etc/audit/auditd.conf

Expected result:

write_logs = yes

If there is no output, this is not a finding.

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000011">
    <title>SRG-OS-000038-GPOS-00016</title>
    <Rule id="r_PHTN-30-000011" severity="medium">
      <version>PHTN-30-000011</version>
      <title>The Photon operating system must configure auditd to use the correct log format.</title>
      <description>&lt;VulnDiscussion&gt;To compile an accurate risk assessment and provide forensic analysis,
it is essential for security personnel to know know exact, unfiltered details
of the event in question.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000131</ident>
      <fixtext>Navigate to and open:

/etc/audit/auditd.conf

Ensure that the "log_format" line is uncommented and set to the following:

log_format = RAW

At the command line, execute the following command:

# killproc auditd -TERM
# systemctl start auditd</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# grep "^log_format" /etc/audit/auditd.conf

Expected result:

log_format = RAW

If there is no output, this is not a finding.

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000012">
    <title>SRG-OS-000042-GPOS-00020</title>
    <Rule id="r_PHTN-30-000012" severity="medium">
      <version>PHTN-30-000012</version>
      <title>The Photon operating system must be configured to audit the execution of privileged functions.</title>
      <description>&lt;VulnDiscussion&gt;Misuse of privileged functions, either intentionally or
unintentionally by authorized users, or by unauthorized external entities that
have compromised information system accounts, is a serious and ongoing concern
and can have significant adverse impacts on organizations. Auditing all actions
by superusers is one way to detect such misuse and identify the risk from
insider threats and the advanced persistent threat.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000135</ident>
      <fixtext>Navigate to and open:

    /etc/audit/rules.d/audit.STIG.rules

    Add the following lines:

    -a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -F key=execpriv
    -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -F key=execpriv
    -a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0 -F key=execpriv
    -a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0 -F key=execpriv

    At the command line, execute the following command to load the new audit
rules.

    # /sbin/augenrules --load

    Note: An older audit.STIG.rules may exist if the file exists and references 
    older "GEN" SRG IDs. This file can be removed and replaced as necessary 
    with an updated one.</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# auditctl -l | grep execve

Expected result:

-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -F key=execpriv
-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -F key=execpriv
-a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0 -F key=execpriv
-a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0 -F key=execpriv

If the output does not match the expected result, this is a finding.

Note: This check depends on the auditd service to be in a running state for 
accurate results. Enabling the auditd service is done in control PHTN-30-000013.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000013">
    <title>SRG-OS-000042-GPOS-00021</title>
    <Rule id="r_PHTN-30-000013" severity="medium">
      <version>PHTN-30-000013</version>
      <title>The Photon operating system must have the auditd service running.</title>
      <description>&lt;VulnDiscussion&gt;Without the capability to generate audit records, it would be
difficult to establish, correlate, and investigate the events relating to an
incident or identify those responsible for one. To that end, the auditd service
must be configured to start automatically and be running at all times.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000135</ident>
      <fixtext>At the command line, execute the following command(s):

# systemctl enable auditd
# systemctl start auditd</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# systemctl status auditd

If the service is not running, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000014">
    <title>SRG-OS-000046-GPOS-00022</title>
    <Rule id="r_PHTN-30-000014" severity="medium">
      <version>PHTN-30-000014</version>
      <title>The Photon operating system audit log must log space limit problems to syslog.</title>
      <description>&lt;VulnDiscussion&gt;It is critical for the appropriate personnel to be aware if a system
is at risk of failing to process audit logs as required. Without this
notification, the security personnel may be unaware of an impending failure of
the audit capability, and system operation may be adversely affected.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000139</ident>
      <fixtext>Navigate to and open:

    /etc/audit/auditd.conf

    Ensure that the "space_left_action" line is uncommented and set to the
following:

    space_left_action = SYSLOG

    At the command line, execute the following command(s):

    # killproc auditd -TERM
    # systemctl start auditd</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# grep "^space_left_action" /etc/audit/auditd.conf

Expected result:

space_left_action = SYSLOG

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000015">
    <title>SRG-OS-000047-GPOS-00023</title>
    <Rule id="r_PHTN-30-000015" severity="medium">
      <version>PHTN-30-000015</version>
      <title>The Photon operating system audit log must attempt to log audit failures to syslog.</title>
      <description>&lt;VulnDiscussion&gt;It is critical for the appropriate personnel to be aware if a system
is at risk of failing to process audit logs as required. Without this
notification, the security personnel may be unaware of an impending failure of
the audit capability, and system operation may be adversely affected.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000140</ident>
      <fixtext>Navigate to and open:

    /etc/audit/auditd.conf

    Ensure that the following lines are present, not duplicated, and not
commented:

    disk_full_action = SYSLOG
    disk_error_action = SYSLOG
    admin_space_left_action = SYSLOG

    At the command line, execute the following command(s):

    # killproc auditd -TERM
    # systemctl start auditd</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # grep -E "^disk_full_action|^disk_error_action|^admin_space_left_action"
/etc/audit/auditd.conf

    If any of the above parameters are not set to SYSLOG or are missing, this
is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000016">
    <title>SRG-OS-000057-GPOS-00027</title>
    <Rule id="r_PHTN-30-000016" severity="medium">
      <version>PHTN-30-000016</version>
      <title>The Photon operating system audit log must have correct permissions.</title>
      <description>&lt;VulnDiscussion&gt;Audit information includes all information (e.g., audit records, audit
settings, audit reports) needed to successfully audit operating system activity.

    Unauthorized disclosure of audit records can reveal system and
configuration data to attackers, thus compromising its confidentiality.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000162</ident>
      <fixtext>At the command line, execute the following command:

#  chmod 0600 &lt;audit log file&gt;

Replace &lt;audit log file&gt; with the log files more permissive than 0600.</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # (audit_log_file=$(grep "^log_file" /etc/audit/auditd.conf|sed
s/^[^\/]*//) &amp;&amp; if [ -f "${audit_log_file}" ] ; then printf "Log(s) found
in "${audit_log_file%/*}":    "; stat -c "%n permissions are %a" ${audit_log_file%}*; else printf
"audit log file(s) not found    "; fi)

    If the permissions on any audit log file is more permissive than 0600, this
is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000017">
    <title>SRG-OS-000058-GPOS-00028</title>
    <Rule id="r_PHTN-30-000017" severity="medium">
      <version>PHTN-30-000017</version>
      <title>The Photon operating system audit log must be owned by root.</title>
      <description>&lt;VulnDiscussion&gt;Audit information includes all information (e.g., audit records, audit
settings, audit reports) needed to successfully audit operating system activity.

    Unauthorized disclosure of audit records can reveal system and
configuration data to attackers, thus compromising its confidentiality.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000163</ident>
      <fixtext>At the command line, execute the following command:

#  chown root:root &lt;audit log file&gt;

Replace &lt;audit log file&gt; with the log files not owned by root.</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # (audit_log_file=$(grep "^log_file" /etc/audit/auditd.conf|sed
s/^[^\/]*//) &amp;&amp; if [ -f "${audit_log_file}" ] ; then printf "Log(s) found
in "${audit_log_file%/*}":    "; stat -c "%n is owned by %U" ${audit_log_file%}*; else printf "audit
log file(s) not found    "; fi)

    If any audit log file is not owned by root, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000018">
    <title>SRG-OS-000059-GPOS-00029</title>
    <Rule id="r_PHTN-30-000018" severity="medium">
      <version>PHTN-30-000018</version>
      <title>The Photon operating system audit log must be group-owned by root.</title>
      <description>&lt;VulnDiscussion&gt;Audit information includes all information (e.g., audit records, audit
settings, audit reports) needed to successfully audit operating system activity.

    Unauthorized disclosure of audit records can reveal system and
configuration data to attackers, thus compromising its confidentiality.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000164</ident>
      <fixtext>At the command line, execute the following command:

#  chown root:root &lt;audit log file&gt;

Replace &lt;audit log file&gt; with the log files not group owned by root.</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # (audit_log_file=$(grep "^log_file" /etc/audit/auditd.conf|sed
s/^[^\/]*//) &amp;&amp; if [ -f "${audit_log_file}" ] ; then printf "Log(s) found
in "${audit_log_file%/*}":    "; stat -c "%n is group owned by %G" ${audit_log_file%}*; else printf
"audit log file(s) not found    "; fi)

    If any audit log file is not group-owned by root, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000019">
    <title>SRG-OS-000063-GPOS-00032</title>
    <Rule id="r_PHTN-30-000019" severity="medium">
      <version>PHTN-30-000019</version>
      <title>The Photon operating system must allow only the ISSM (or individuals or roles appointed by the ISSM) to select which auditable events are to be audited.</title>
      <description>&lt;VulnDiscussion&gt;Without the capability to restrict the roles and individuals that can
select which events are audited, unauthorized personnel may be able to prevent
the auditing of critical events. Misconfigured audits may degrade the system's
performance by overwhelming the audit log. Misconfigured audits may also make
it more difficult to establish, correlate, and investigate the events relating
to an incident or identify those responsible for one.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000171</ident>
      <fixtext>At the command line, execute the following command:

# chmod 640 &lt;file&gt;

Replace &lt;file&gt; with any file with incorrect permissions.</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # find /etc/audit/* -type f -exec stat -c "%n permissions are %a" {} $1\;

    If the permissions of any files are more permissive than 640, then this is
a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000020">
    <title>SRG-OS-000064-GPOS-00033</title>
    <Rule id="r_PHTN-30-000020" severity="medium">
      <version>PHTN-30-000020</version>
      <title>The Photon operating system must generate audit records when successful/unsuccessful attempts to access privileges occur.</title>
      <description>&lt;VulnDiscussion&gt;The changing of file permissions could indicate that a user is
attempting to gain access to information that would otherwise be disallowed.
Auditing DAC modifications can facilitate the identification of patterns of
abuse among both authorized and unauthorized users.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000172</ident>
      <fixtext>Navigate to and open:

    /etc/audit/rules.d/audit.STIG.rules

    Add the following lines:

    -a always,exit -F arch=b64 -S chmod,fchmod,chown,fchown,fchownat,fchmodat
-F auid&gt;=1000 -F auid!=4294967295 -F key=perm_mod
    -a always,exit -F arch=b64 -S
chmod,fchmod,chown,fchown,lchown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat
-F key=perm_mod
    -a always,exit -F arch=b32 -S chmod,fchmod,fchown,chown,fchownat,fchmodat
-F auid&gt;=1000 -F auid!=4294967295 -F key=perm_mod
    -a always,exit -F arch=b32 -S
chmod,lchown,fchmod,fchown,chown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat
-F key=perm_mod

    At the command line, execute the following command to load the new audit
rules.

    # /sbin/augenrules --load

    Note: An older audit.STIG.rules may exist if the file exists and references 
    older "GEN" SRG IDs. This file can be removed and replaced as necessary 
    with an updated one.</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # auditctl -l | grep chmod

    Expected result:

    -a always,exit -F arch=b64 -S chmod,fchmod,chown,fchown,fchownat,fchmodat
-F auid&gt;=1000 -F auid!=4294967295 -F key=perm_mod

    -a always,exit -F arch=b64 -S
chmod,fchmod,chown,fchown,lchown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat
-F key=perm_mod

    -a always,exit -F arch=b32 -S chmod,fchmod,fchown,chown,fchownat,fchmodat
-F auid&gt;=1000 -F auid!=4294967295 -F key=perm_mod

    -a always,exit -F arch=b32 -S
chmod,lchown,fchmod,fchown,chown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat
-F key=perm_mod

    If the output does not match the expected result, this is a finding.

    Note: This check depends on the auditd service to be in a running state for 
    accurate results. Enabling the auditd service is done in control PHTN-30-000013.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000021">
    <title>SRG-OS-000069-GPOS-00037</title>
    <Rule id="r_PHTN-30-000021" severity="medium">
      <version>PHTN-30-000021</version>
      <title>The Photon operating system must enforce password complexity by requiring that at least one uppercase character be used.</title>
      <description>&lt;VulnDiscussion&gt;Use of a complex password helps to increase the time and resources
required to compromise the password. Password complexity, or strength, is a
measure of the effectiveness of a password in resisting attempts at guessing
and brute-force attacks.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000192</ident>
      <fixtext>Navigate to and open:

    /etc/pam.d/system-password

    Add the following, replacing any existing "pam_cracklib.so" line:

    password requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1
ocredit=-1 minlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # grep pam_cracklib /etc/pam.d/system-password|grep --color=always
"ucredit=.."

    Expected result:

    password requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1
ocredit=-1 minlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root

    If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000022">
    <title>SRG-OS-000070-GPOS-00038</title>
    <Rule id="r_PHTN-30-000022" severity="medium">
      <version>PHTN-30-000022</version>
      <title>The Photon operating system must enforce password complexity by requiring that at least one lowercase character be used.</title>
      <description>&lt;VulnDiscussion&gt;Use of a complex password helps to increase the time and resources
required to compromise the password. Password complexity, or strength, is a
measure of the effectiveness of a password in resisting attempts at guessing
and brute-force attacks.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000193</ident>
      <fixtext>Navigate to and open:

    /etc/pam.d/system-password

    Add the following, replacing any existing "pam_cracklib.so" line :

    password requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1
ocredit=-1 minlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # grep pam_cracklib /etc/pam.d/system-password|grep --color=always
"lcredit=.."

    Expected result:

    password requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1
ocredit=-1 minlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root

    If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000023">
    <title>SRG-OS-000071-GPOS-00039</title>
    <Rule id="r_PHTN-30-000023" severity="medium">
      <version>PHTN-30-000023</version>
      <title>The Photon operating system must enforce password complexity by requiring that at least one numeric character be used.</title>
      <description>&lt;VulnDiscussion&gt;Use of a complex password helps to increase the time and resources
required to compromise the password. Password complexity, or strength, is a
measure of the effectiveness of a password in resisting attempts at guessing
and brute-force attacks.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000194</ident>
      <fixtext>Navigate to and open:

    /etc/pam.d/system-password

    Add the following, replacing any existing "pam_cracklib.so" line :

    password requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1
ocredit=-1 minlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # grep pam_cracklib /etc/pam.d/system-password|grep --color=always
"dcredit=.."

    Expected result:

    password requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1
ocredit=-1 minlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root

    If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000024">
    <title>SRG-OS-000072-GPOS-00040</title>
    <Rule id="r_PHTN-30-000024" severity="medium">
      <version>PHTN-30-000024</version>
      <title>The Photon operating system must require that new passwords are at least four characters different from the old password.</title>
      <description>&lt;VulnDiscussion&gt;Use of a complex password helps to increase the time and resources
required to compromise the password. Password complexity, or strength, is a
measure of the effectiveness of a password in resisting attempts at guessing
and brute-force attacks.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000195</ident>
      <fixtext>Navigate to and open:

    /etc/pam.d/system-password

    Add the following, replacing any existing "pam_cracklib.so" line :

    password requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1
ocredit=-1 minlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # grep pam_cracklib /etc/pam.d/system-password|grep --color=always
"difok=."

    Expected result:

    password requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1
ocredit=-1 minlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root

    If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000025">
    <title>SRG-OS-000073-GPOS-00041</title>
    <Rule id="r_PHTN-30-000025" severity="medium">
      <version>PHTN-30-000025</version>
      <title>The Photon operating system must store only encrypted representations of passwords.</title>
      <description>&lt;VulnDiscussion&gt;Passwords must be protected at all times via strong, one way
encryption. If passwords are not encrypted, they can be plainly read (i.e.,
clear text) and easily compromised. If they are encrypted with a weak cipher,
those password are much more vulnerability to offline bute forcing attacks&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000196</ident>
      <fixtext>Navigate to and open:

/etc/login.defs

Add or replace the ENCRYPT_METHOD line as follows:

ENCRYPT_METHOD SHA512</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # grep SHA512 /etc/login.defs|grep -v "#"

    Expected result :

    ENCRYPT_METHOD SHA512

    If there is no output or if the output does match the expected result, this
is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000026">
    <title>SRG-OS-000074-GPOS-00042</title>
    <Rule id="r_PHTN-30-000026" severity="medium">
      <version>PHTN-30-000026</version>
      <title>The Photon operating system must use OpenSSH for remote maintenance sessions.</title>
      <description>&lt;VulnDiscussion&gt;Passwords need to be protected at all times, and encryption is the
standard method for protecting passwords. If passwords are not encrypted, they
can be plainly read (i.e., clear text) and easily compromised.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000197</ident>
      <fixtext>Installing openssh manually is not supported by VMware for
appliances. Revert to a previous backup or redeploy the appliance.</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# rpm -qa|grep openssh

If there is no output or openssh is not &gt;=  version 7.6, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000027">
    <title>SRG-OS-000075-GPOS-00043</title>
    <Rule id="r_PHTN-30-000027" severity="medium">
      <version>PHTN-30-000027</version>
      <title>The Photon operating system must be configured so that passwords for new users are restricted to a 24-hour minimum lifetime.</title>
      <description>&lt;VulnDiscussion&gt;Enforcing a minimum password lifetime helps to prevent repeated
password changes to defeat the password reuse or history enforcement
requirement. If users are allowed to immediately and continually change their
password, the password could be repeatedly changed in a short period of time to
defeat the organization's policy regarding password reuse.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000198</ident>
      <fixtext>Navigate to and open:

/etc/login.defs

Modify the PASS_MIN_DAYS line to the following:

PASS_MIN_DAYS   1</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# grep "^PASS_MIN_DAYS" /etc/login.defs

If "PASS_MIN_DAYS" is not set to 1, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000028">
    <title>SRG-OS-000076-GPOS-00044</title>
    <Rule id="r_PHTN-30-000028" severity="medium">
      <version>PHTN-30-000028</version>
      <title>The Photon operating system must be configured so that passwords for new users are restricted to a 90-day maximum lifetime.</title>
      <description>&lt;VulnDiscussion&gt;Any password, no matter how complex, can eventually be cracked.
Therefore, passwords need to be changed periodically. If the operating system
does not limit the lifetime of passwords and force users to change their
passwords, there is the risk that the operating system passwords could be
compromised.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000199</ident>
      <fixtext>Navigate to and open:

/etc/login.def

Modify the PASS_MAX_DAYS line to the following:

PASS_MAX_DAYS   90</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# grep "^PASS_MAX_DAYS" /etc/login.defs

If the value of "PASS_MAX_DAYS" is greater than 90, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000029">
    <title>SRG-OS-000077-GPOS-00045</title>
    <Rule id="r_PHTN-30-000029" severity="medium">
      <version>PHTN-30-000029</version>
      <title>The Photon operating system must prohibit password reuse for a minimum of five generations.</title>
      <description>&lt;VulnDiscussion&gt;Password complexity, or strength, is a measure of the effectiveness of
a password in resisting attempts at guessing and brute-force attacks. If the
information system or application allows the user to consecutively reuse their
password when that password has exceeded its defined lifetime, the end result
is a password that is not changed as per policy requirements.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000200</ident>
      <fixtext>Navigate to and open:

    /etc/pam.d/system-password

    Add the following line after the "password requisite pam_cracklib.so"
statement:

    password requisite pam_pwhistory.so enforce_for_root use_authtok remember=5
retry=3</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # grep pam_pwhistory /etc/pam.d/system-password|grep --color=always
"remember=."

    Expected result:

    password requisite pam_pwhistory.so enforce_for_root use_authtok remember=5
retry=3

    If the output does include the "remember=5" setting as shown in the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000030">
    <title>SRG-OS-000078-GPOS-00046</title>
    <Rule id="r_PHTN-30-000030" severity="medium">
      <version>PHTN-30-000030</version>
      <title>The Photon operating system must enforce a minimum eight-character password length.</title>
      <description>&lt;VulnDiscussion&gt;The shorter the password, the lower the number of possible
combinations that need to be tested before the password is compromised.

    Password complexity, or strength, is a measure of the effectiveness of a
password in resisting attempts at guessing and brute-force attacks. Password
length is one factor of several that helps to determine strength and how long
it takes to crack a password. Use of more characters in a password helps to
exponentially increase the time and/or resources required to compromise the
password.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000205</ident>
      <fixtext>Navigate to and open:

    /etc/pam.d/system-password

    Add the following, replacing any existing "pam_cracklib.so" line:

    password requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1
ocredit=-1 minlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # grep pam_cracklib /etc/pam.d/system-password|grep --color=always
"minlen=.."

    Expected result:

    password requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1
ocredit=-1 minlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root

    If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000031">
    <title>SRG-OS-000080-GPOS-00048</title>
    <Rule id="r_PHTN-30-000031" severity="low">
      <version>PHTN-30-000031</version>
      <title>The Photon operating system must require authentication upon booting into single-user and maintenance modes.</title>
      <description>&lt;VulnDiscussion&gt;If the system does not require authentication before it boots into
single-user mode, anyone with console access to the system can trivially access
all files on the system. GRUB2 is the boot loader for Photon OS and is can be
configured to require a password to boot into single-user mode or make
modifications to the boot menu.

    Note: Photon does not support building grub changes via grub2-mkconfig.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000213</ident>
      <fixtext>At the command line, execute the following command:

    # grub2-mkpasswd-pbkdf2

    Enter a secure password and ensure this password is stored for break-glass
situations. You will not be able to recover the vCenter root account without
knowing this separate password. Copy the resulting encrypted string.

    An example string is below:


grub.pbkdf2.sha512.10000.983A13DF3C51BB2B5130F0B86DDBF0DEA1AAF766BD1F16B7840F79CE3E35494C4B99F505C99C150071E563DF1D7FE1F45456D5960C4C79DAB6C49298B02A5558.5B2C49E12D43CC5A876F6738462DE4EFC24939D4BE486CDB72CFBCD87FDE93FBAFCB817E01B90F23E53C2502C3230502BC3113BE4F80B0AFC0EE956E735F7F86

    Navigate to and open:

    /boot/grub2/grub.cfg

    Find the line that begins with "set rootpartition". Below this line,
paste the following on its own line:

    set superusers="root"

    Below this paste the following, substituting your own encrypted string from
the steps above:

    password_pbkdf2 root &lt;YOUR-LONG-STRING-FROM-ABOVE&gt;

    Photon ships with one menuentry block by default. Copy that entire block
and paste it right below itself.

    Example:
    menuentry "Photon" {
        linux "/"$photon_linux root=$rootpartition net.ifnames=0
$photon_cmdline coredump_filter=0x37 consoleblank=0
        if [ "$photon_initrd" ]; then
            initrd "/"$photon_initrd
        fi
    }
    menuentry "Photon" {
        linux "/"$photon_linux root=$rootpartition net.ifnames=0
$photon_cmdline coredump_filter=0x37 consoleblank=0
        if [ "$photon_initrd" ]; then
            initrd "/"$photon_initrd
        fi
    }

    Modify the first menuentry block to add the "--unrestricted" option as
follows:

    menuentry "Photon" --unrestricted {

    Modify the second menuentry block to add the allowed user as follows

    menuentry "Recover Photon" --users root {

    This concludes the fix. To verify, here is an example grub.cfg snippet.

    ...
    set rootpartition=PARTUUID=326e5b0f-42fb-471a-8209-18964c4a2ed3
    set superusers="root"
    password_pbkdf2 root
grub.pbkdf2.sha512.10000.983A13DF3C51BB2B5130F0B86DDBF0DEA1AAF766BD1F16B7840F79CE3E35494C4B99F505C99C150071E563DF1D7FE1F45456D5960C4C79DAB6C49298B02A5558.5B2C49E12D43CC5A876F6738462DE4EFC24939D4BE486CDB72CFBCD87FDE93FBAFCB817E01B90F23E53C2502C3230502BC3113BE4F80B0AFC0EE956E735F7F86

    menuentry "Photon" --unrestricted {
        linux "/"$photon_linux root=$rootpartition net.ifnames=0
$photon_cmdline coredump_filter=0x37 consoleblank=0
        if [ "$photon_initrd" ]; then
            initrd "/"$photon_initrd
        fi
    }

    menuentry "Recover Photon" --users root {
        linux "/"$photon_linux root=$rootpartition net.ifnames=0
$photon_cmdline coredump_filter=0x37 consoleblank=0
        if [ "$photon_initrd" ]; then
            initrd "/"$photon_initrd
        fi
    }</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # grep -i ^password_pbkdf2 /boot/grub2/grub.cfg

    If there is not output, this is a finding.

    If the output does not begin with "password_pbkdf2 root", this is a
finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000032">
    <title>SRG-OS-000096-GPOS-00050</title>
    <Rule id="r_PHTN-30-000032" severity="medium">
      <version>PHTN-30-000032</version>
      <title>The Photon operating system must disable the loading of unnecessary kernel modules.</title>
      <description>&lt;VulnDiscussion&gt;To support the requirements and principles of least functionality, the
operating system must provide only essential capabilities and limit the use of
modules, protocols, and/or services to only those required for the proper
functioning of the product.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000382</ident>
      <fixtext>Navigate to and open:

/etc/modprobe.d/modprobe.conf

Set the contents as follows:

install sctp /bin/false
install dccp /bin/false
install dccp_ipv4 /bin/false
install dccp_ipv6 /bin/false
install ipx /bin/false
install appletalk /bin/false
install decnet /bin/false
install rds /bin/false
install tipc /bin/false
install bluetooth /bin/false
install usb_storage /bin/false
install ieee1394 /bin/false
install cramfs /bin/false
install freevxfs /bin/false
install jffs2 /bin/false
install hfs /bin/false
install hfsplus /bin/false
install squashfs /bin/false
install udf /bin/false</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# modprobe --showconfig | grep "^install" | grep "/bin"

Expected result:

install sctp /bin/false
install dccp /bin/false
install dccp_ipv4 /bin/false
install dccp_ipv6 /bin/false
install ipx /bin/false
install appletalk /bin/false
install decnet /bin/false
install rds /bin/false
install tipc /bin/false
install bluetooth /bin/false
install usb_storage /bin/false
install ieee1394 /bin/false
install cramfs /bin/false
install freevxfs /bin/false
install jffs2 /bin/false
install hfs /bin/false
install hfsplus /bin/false
install squashfs /bin/false
install udf /bin/false

The output may include other statements outside of the expected result.

If the output does not include at least every statement in the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000033">
    <title>SRG-OS-000104-GPOS-00051</title>
    <Rule id="r_PHTN-30-000033" severity="medium">
      <version>PHTN-30-000033</version>
      <title>The Photon operating system must not have Duplicate User IDs (UIDs).</title>
      <description>&lt;VulnDiscussion&gt;To ensure accountability and prevent unauthenticated access,
organizational users must be uniquely identified and authenticated to prevent
potential misuse and provide for non-repudiation.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000764</ident>
      <fixtext>Navigate to and open:

/etc/passwd

Configure each user account that has a duplicate UID with a unique UID.</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# awk -F ":" 'list[$3]++{print $1, $3}' /etc/passwd

If any lines are returned, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000035">
    <title>SRG-OS-000118-GPOS-00060</title>
    <Rule id="r_PHTN-30-000035" severity="medium">
      <version>PHTN-30-000035</version>
      <title>The Photon operating system must disable new accounts immediately upon password expiration.</title>
      <description>&lt;VulnDiscussion&gt;Inactive identifiers pose a risk to systems and applications because
attackers may exploit an inactive identifier and potentially obtain undetected
access to the system. Owners of inactive accounts will not notice if
unauthorized access to their user account has been obtained.

    Disabling inactive accounts ensures that accounts that may not have been
responsibly removed are not available to attackers who may have compromised
their credentials.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000795</ident>
      <fixtext>Navigate to and open:

/etc/default/useradd

Remove and existing "INACTIVE" line and add the following line:

INACTIVE=0</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# grep INACTIVE /etc/default/useradd

Expected result:

INACTIVE=0

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000036">
    <title>SRG-OS-000142-GPOS-00071</title>
    <Rule id="r_PHTN-30-000036" severity="medium">
      <version>PHTN-30-000036</version>
      <title>The Photon operating system must use TCP syncookies.</title>
      <description>&lt;VulnDiscussion&gt;A TCP SYN flood attack can cause a denial of service by filling a
system's TCP connection table with connections in the SYN_RCVD state.
Syncookies can be used to track a connection when a subsequent ACK is received,
verifying the initiator is attempting a valid connection and is not a flood
source. This feature is activated when a flood condition is detected and
enables the system to continue servicing valid connection requests.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-001095</ident>
      <fixtext>At the command line, execute the following command(s):

# sed -i -e "/^net.ipv4.tcp_syncookies/d" /etc/sysctl.conf
# echo net.ipv4.tcp_syncookies=1&gt;&gt;/etc/sysctl.conf
# /sbin/sysctl --load</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# /sbin/sysctl -a --pattern tcp_syncookies

Expected result:

net.ipv4.tcp_syncookies = 1

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000037">
    <title>SRG-OS-000163-GPOS-00072</title>
    <Rule id="r_PHTN-30-000037" severity="medium">
      <version>PHTN-30-000037</version>
      <title>The Photon operating system must configure sshd to disconnect idle SSH sessions.</title>
      <description>&lt;VulnDiscussion&gt;Terminating an idle session within a short time period reduces the
window of opportunity for unauthorized personnel to take control of a
management session enabled on the console or console port that has been left
unattended.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-001133</ident>
      <fixtext>Navigate to and open:

    /etc/ssh/sshd_config

    Ensure that the "ClientAliveInterval" line is uncommented and set to the
following:

    ClientAliveInterval 900

    At the command line, execute the following command:

    # systemctl restart sshd.service</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# sshd -T|&amp;grep -i ClientAliveInterval

Expected result:

ClientAliveInterval 900

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000038">
    <title>SRG-OS-000163-GPOS-00072</title>
    <Rule id="r_PHTN-30-000038" severity="medium">
      <version>PHTN-30-000038</version>
      <title>The Photon operating system must configure sshd to disconnect idle SSH sessions.</title>
      <description>&lt;VulnDiscussion&gt;Terminating an idle session within a short time period reduces the
window of opportunity for unauthorized personnel to take control of a
management session enabled on the console or console port that has been left
unattended.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-001133</ident>
      <fixtext>Navigate to and open:

    /etc/ssh/sshd_config

    Ensure that the "ClientAliveCountMax" line is uncommented and set to the
following:

    ClientAliveCountMax 0

    At the command line, execute the following command:

    # systemctl restart sshd.service</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# sshd -T|&amp;grep -i ClientAliveCountMax

Expected result:

ClientAliveCountMax 0

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000039">
    <title>SRG-OS-000205-GPOS-00083</title>
    <Rule id="r_PHTN-30-000039" severity="medium">
      <version>PHTN-30-000039</version>
      <title>The Photon operating system must configure rsyslog to offload system logs to a central server.</title>
      <description>&lt;VulnDiscussion&gt;Information stored in one location is vulnerable to accidental or
incidental deletion or alteration. Proper configuration of rsyslog ensures that
information critical to forensic analysis of security events is available for
future action without any manual offloading or cron jobs.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-001312</ident>
      <fixtext>Examples are provided for UDP, TCP, and TLS configurations.  Substitute the
environments approved syslog server for &lt;syslog server:port&gt; for the protocol
of choice.

    For Example:

    *.* @mysyslog.domain.local:514;RSYSLOG_syslogProtocol23Format

    Navigate to and open:

    /etc/rsyslog.conf

    Remove any existing content and create a new remote server configuration
line:

     For UDP

     *.* @&lt;syslog server:port&gt;;RSYSLOG_syslogProtocol23Format

     For TCP

     *.* @@&lt;syslog server:port&gt;;RSYSLOG_syslogProtocol23Format

     For TLS

     *.* @@(o)&lt;syslog server:port&gt;;RSYSLOG_syslogProtocol23Format

    At the command line, execute the following command:

     # systemctl restart rsyslog.service</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

     # cat /etc/rsyslog.conf

     The output should be similar to the following where &lt;syslog server:port&gt;
is set to the environments approved syslog server:

     *.* @&lt;syslog server:port&gt;;RSYSLOG_syslogProtocol23Format

     If no line is returned or if the line is commented or no valid syslog
server is specified, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000040">
    <title>SRG-OS-000206-GPOS-00084</title>
    <Rule id="r_PHTN-30-000040" severity="medium">
      <version>PHTN-30-000040</version>
      <title>The Photon operating system /var/log directory must be owned by root.</title>
      <description>&lt;VulnDiscussion&gt;Only authorized personnel should be aware of errors and the details of
the errors. Error messages are an indicator of an organization's operational
state and can provide sensitive information to an unprivileged attacker.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-001314</ident>
      <fixtext>At the command line, execute the following command:

# chown root:root /var/log</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# stat -c "%n is owned by %U and group owned by %G" /var/log

If the /var/log directory is not owned by root, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000041">
    <title>SRG-OS-000206-GPOS-00084</title>
    <Rule id="r_PHTN-30-000041" severity="medium">
      <version>PHTN-30-000041</version>
      <title>The Photon operating system messages file have the correct ownership and file permissions.</title>
      <description>&lt;VulnDiscussion&gt;Only authorized personnel should be aware of errors and the details of
the errors. Error messages are an indicator of an organization's operational
state and can provide sensitive information to an unprivileged attacker.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-001314</ident>
      <fixtext>At the command line, execute the following command(s):

# chown root:root /var/log/messages

# chmod 0640 /var/log/messages</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # stat -c "%n is owned by %U and group owned by %G with %a permissions"
/var/log/messages

    If the /var/log/messages directory is not owned by root or not group owned
by root or the file permissions are more permission than 640, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000042">
    <title>SRG-OS-000239-GPOS-00089</title>
    <Rule id="r_PHTN-30-000042" severity="medium">
      <version>PHTN-30-000042</version>
      <title>The Photon operating system must audit all account modifications.</title>
      <description>&lt;VulnDiscussion&gt;Once an attacker establishes access to a system, the attacker often
attempts to create a persistent method of reestablishing access.  One way to
accomplish this is for the attacker to modify an existing account.  Auditing
account modification actions provides logging that can be used for forensic
purposes.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-001403</ident>
      <fixtext>Navigate to and open:

    /etc/audit/rules.d/audit.STIG.rules

    Add the following lines:

    -w /usr/sbin/usermod -p x -k usermod
    -w /usr/sbin/groupmod -p x -k groupmod

    At the command line, execute the following command to load the new audit
rules.

    # /sbin/augenrules --load

    Note: An older audit.STIG.rules may exist if the file exists and references 
    older "GEN" SRG IDs. This file can be removed and replaced as necessary 
    with an updated one.</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# auditctl -l | grep -E "(usermod|groupmod)"

Expected result:

-w /usr/sbin/usermod -p x -k usermod
-w /usr/sbin/groupmod -p x -k groupmod

If the output does not match the expected result, this is a finding.

Note: This check depends on the auditd service to be in a running state for 
accurate results. Enabling the auditd service is done in control PHTN-30-000013.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000043">
    <title>SRG-OS-000239-GPOS-00089</title>
    <Rule id="r_PHTN-30-000043" severity="medium">
      <version>PHTN-30-000043</version>
      <title>The Photon operating system must audit all account modifications.</title>
      <description>&lt;VulnDiscussion&gt;Once an attacker establishes access to a system, the attacker often
attempts to create a persistent method of reestablishing access.  One way to
accomplish this is for the attacker to modify an existing account.  Auditing
account modification actions provides logging that can be used for forensic
purposes.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-001403</ident>
      <fixtext>Navigate to and open:

    /etc/audit/rules.d/audit.STIG.rules

    Add the following lines:

    -w /etc/passwd -p wa -k passwd
    -w /etc/shadow -p wa -k shadow
    -w /etc/group -p wa -k group
    -w /etc/gshadow -p wa -k gshadow

    At the command line, execute the following command to load the new audit
rules.

    # /sbin/augenrules --load

    Note: An older audit.STIG.rules may exist if the file exists and references 
    older "GEN" SRG IDs. This file can be removed and replaced as necessary 
    with an updated one.</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # auditctl -l | grep -E
"(/etc/passwd|/etc/shadow|/etc/group|/etc/gshadow)"

    Expected result:

    -w /etc/passwd -p wa -k passwd
    -w /etc/shadow -p wa -k shadow
    -w /etc/group -p wa -k group
    -w /etc/gshadow -p wa -k gshadow

    If the output does not match the expected result, this is a finding.

    Note: This check depends on the auditd service to be in a running state for 
    accurate results. Enabling the auditd service is done in control PHTN-30-000013.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000044">
    <title>SRG-OS-000240-GPOS-00090</title>
    <Rule id="r_PHTN-30-000044" severity="medium">
      <version>PHTN-30-000044</version>
      <title>The Photon operating system must audit all account disabling actions.</title>
      <description>&lt;VulnDiscussion&gt;When operating system accounts are disabled, user accessibility is
affected. Accounts are used for identifying individual users or for identifying
the operating system processes themselves. In order to detect and respond to
events affecting user accessibility and system processing, operating systems
must audit account disabling actions.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-001404</ident>
      <fixtext>Navigate to and open:

    /etc/audit/rules.d/audit.STIG.rules

    Add the following lines:

    -w /usr/bin/passwd -p x -k passwd

     At the command line, execute the following command to load the new audit
rules.

    # /sbin/augenrules --load

    Note: An older audit.STIG.rules may exist if the file exists and references 
    older "GEN" SRG IDs. This file can be removed and replaced as necessary 
    with an updated one.</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

 # auditctl -l | grep "w /usr/bin/passwd"

 Expected result:

 -w /usr/bin/passwd -p x -k passwd

 If the output does not match the expected result, this is a finding.

 Note: This check depends on the auditd service to be in a running state for 
accurate results. Enabling the auditd service is done in control PHTN-30-000013.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000045">
    <title>SRG-OS-000241-GPOS-00091</title>
    <Rule id="r_PHTN-30-000045" severity="medium">
      <version>PHTN-30-000045</version>
      <title>The Photon operating system must audit all account removal actions.</title>
      <description>&lt;VulnDiscussion&gt;When operating system accounts are removed, user accessibility is
affected. Accounts are used for identifying individual users or for identifying
the operating system processes themselves. In order to detect and respond to
events affecting user accessibility and system processing, operating systems
must audit account removal actions.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-001405</ident>
      <fixtext>Navigate to and open:

    /etc/audit/rules.d/audit.STIG.rules

    Add the following lines:

    -w /usr/sbin/userdel -p x -k userdel
    -w /usr/sbin/groupdel -p x -k groupdel

    At the command line, execute the following command to load the new audit
rules.

    # /sbin/augenrules --load

    Note: An older audit.STIG.rules may exist if the file exists and references 
    older "GEN" SRG IDs. This file can be removed and replaced as necessary 
    with an updated one.</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# auditctl -l | grep -E "(userdel|groupdel)"

Expected result:

-w /usr/sbin/userdel -p x -k userdel
-w /usr/sbin/groupdel -p x -k groupdel

If the output does not match the expected result, this is a finding.

Note: This check depends on the auditd service to be in a running state for 
accurate results. Enabling the auditd service is done in control PHTN-30-000013.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000046">
    <title>SRG-OS-000254-GPOS-00095</title>
    <Rule id="r_PHTN-30-000046" severity="medium">
      <version>PHTN-30-000046</version>
      <title>The Photon operating system must initiate auditing as part of the boot process.</title>
      <description>&lt;VulnDiscussion&gt;Each process on the system carries an "auditable" flag, which
indicates whether its activities can be audited. Although auditd takes care of
enabling this for all processes that launch after it starts, adding the kernel
argument ensures the flag is set at boot for every process on the system. This
includes processes created before auditd starts.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-001464</ident>
      <fixtext>Navigate to and open:

    /boot/grub2/grub.cfg

    Locate the boot command line arguments. An example follows:

    linux /$photon_linux root=$rootpartition $photon_cmdline $systemd_cmdline

    Add "audit=1" to the end of the line so it reads as follows:

    linux /$photon_linux root=$rootpartition $photon_cmdline $systemd_cmdline
audit=1

    Note: Do not copy/paste in this example argument line. This may change in
future releases. Find the similar line and append "audit=1" to it.

    Reboot the system for the change to take effect.</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# grep "audit=1" /proc/cmdline

If no results are returned, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000047">
    <title>SRG-OS-000256-GPOS-00097</title>
    <Rule id="r_PHTN-30-000047" severity="medium">
      <version>PHTN-30-000047</version>
      <title>The Photon operating system audit files and directories must have correct permissions.</title>
      <description>&lt;VulnDiscussion&gt;Protecting audit information also includes identifying and protecting
the tools used to view and manipulate log data. Therefore, protecting audit
tools is necessary to prevent unauthorized operations on audit information.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-001493</ident>
      <fixtext>At the command line, execute the following command:

# chown root:root /etc/audit/auditd.conf</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # stat -c "%n is owned by %U and group owned by %G" /etc/audit/auditd.conf

    If auditd.conf is not owned by root and group owned by root, this is a
finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000048">
    <title>SRG-OS-000257-GPOS-00098</title>
    <Rule id="r_PHTN-30-000048" severity="medium">
      <version>PHTN-30-000048</version>
      <title>The Photon operating system must protect audit tools from unauthorized modification and deletion.</title>
      <description>&lt;VulnDiscussion&gt;Protecting audit information also includes identifying and protecting
the tools used to view and manipulate log data. Therefore, protecting audit
tools is necessary to prevent unauthorized operations on audit information.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-001494</ident>
      <fixtext>At the command line, execute the following command for each file returned
for user and group ownership:

    # chown root:root &lt;file&gt;

    At the command line, execute the following command for each file returned
for file permissions:

    # chmod 750 &lt;file&gt;</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # stat -c "%n is owned by %U and group owned by %G and permissions are
%a" /usr/sbin/auditctl /usr/sbin/auditd /usr/sbin/aureport /usr/sbin/ausearch
/usr/sbin/autrace

    If any file is not owned by root or group owned by root or permissions are
more permissive than 750, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000049">
    <title>SRG-OS-000259-GPOS-00100</title>
    <Rule id="r_PHTN-30-000049" severity="medium">
      <version>PHTN-30-000049</version>
      <title>The Photon operating system must limit privileges to change software resident within software libraries.</title>
      <description>&lt;VulnDiscussion&gt;On the Photon operating system, system-wide shared library files,
which are linked to executables during process load time or run time, are
stored in /usr/lib by default. All files on those paths must be owned by root
in order to help prevent tampering and unintended behavior.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-001499</ident>
      <fixtext>At the command line, execute the following command for each file returned
for user and group ownership:

    # chown root:root &lt;file&gt;

    At the command line, execute the following command for each file returned
for file permissions:

    # chmod 755 &lt;file&gt;</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # find /usr/lib/ -type f "(" ! -user root -o ! -group root -o -perm /022
")" -printf '%p, %u:%g:%m    '

    If there is any output, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000050">
    <title>SRG-OS-000266-GPOS-00101</title>
    <Rule id="r_PHTN-30-000050" severity="medium">
      <version>PHTN-30-000050</version>
      <title>The Photon operating system must enforce password complexity by requiring that at least one special character be used.</title>
      <description>&lt;VulnDiscussion&gt;Use of a complex password helps to increase the time and resources
required to compromise the password. Password complexity, or strength, is a
measure of the effectiveness of a password in resisting attempts at guessing
and brute-force attacks.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-001619</ident>
      <fixtext>Navigate to and open:

    /etc/pam.d/system-password

    Add the following, replacing any existing "pam_cracklib.so" line:

    password requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1
ocredit=-1 minlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # grep pam_cracklib /etc/pam.d/system-password|grep --color=always
"ocredit=.."

    Expected result:

    password requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1
ocredit=-1 minlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root

    If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000051">
    <title>SRG-OS-000278-GPOS-00108</title>
    <Rule id="r_PHTN-30-000051" severity="medium">
      <version>PHTN-30-000051</version>
      <title>The Photon operating system package files must not be modified.</title>
      <description>&lt;VulnDiscussion&gt;Protecting the integrity of the tools used for auditing purposes is a
critical step toward ensuring the integrity of audit information. Audit
information includes all information (e.g., audit records, audit settings, and
audit reports) needed to successfully audit information system activity.

    Without confidence in the integrity of the auditing system and tools, the
information it provides cannot be trusted.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-001496</ident>
      <fixtext>If the audit system binaries have been altered the system must be taken
offline and your ISSM must be notified immediately.

    Reinstalling the audit tools is not supported. The appliance should be
restored from a backup or redeployed once the root cause is remediated.</fixtext>
      <check system="N/A">
        <check-content>Use the verification capability of rpm to check the MD5 hashes of the audit
files on disk versus the expected ones from the installation package.

    At the command line, execute the following command:

    # rpm -V audit | grep "^..5" | grep -v "^...........c"

    If there is any output, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000052">
    <title>SRG-OS-000279-GPOS-00109</title>
    <Rule id="r_PHTN-30-000052" severity="medium">
      <version>PHTN-30-000052</version>
      <title>The Photon operating system must set an inactivity timeout value for non-interactive sessions.</title>
      <description>&lt;VulnDiscussion&gt;A session timeout is an action taken when a session goes idle for any
reason. Rather than relying on the user to manually disconnect their session
prior to going idle, the Photon operating system must be able to identify when
a session has idled and take action to terminate the session.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-002361</ident>
      <fixtext>Navigate to and open:

/etc/bash.bashrc

Add the following to the end of the file:

TMOUT=900
readonly TMOUT
export TMOUT</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # grep TMOUT /etc/bash.bashrc

    Expected result:

    TMOUT=900
    readonly TMOUT
    export TMOUT

    If the file does not exist or the output does not match the expected
result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000053">
    <title>SRG-OS-000297-GPOS-00115</title>
    <Rule id="r_PHTN-30-000053" severity="medium">
      <version>PHTN-30-000053</version>
      <title>The Photon operating system must configure sshd with a specific ListenAddress.</title>
      <description>&lt;VulnDiscussion&gt;Without specifying a ListenAddress, sshd will listen on all
interfaces. In situations with multiple interfaces, this may not be intended
behavior and could lead to offering remote access on an unapproved network.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-002314</ident>
      <fixtext>Navigate to and open:

    /etc/ssh/sshd_config

    Ensure that the "ListenAddress" line is uncommented and set to a valid
local IP:

    Example:

    ListenAddress 169.254.1.2

    Replace '169.254.1.2' with the management address of the Photon deployment.

    At the command line, execute the following command:

    # systemctl restart sshd.service</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # sshd -T|&amp;grep -i ListenAddress

    If the "ListenAddress" is not configured to the Photon management IP,
this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000054">
    <title>SRG-OS-000327-GPOS-00127</title>
    <Rule id="r_PHTN-30-000054" severity="medium">
      <version>PHTN-30-000054</version>
      <title>The Photon operating system must audit the execution of privileged functions.</title>
      <description>&lt;VulnDiscussion&gt;Misuse of privileged functions, either intentionally or
unintentionally by authorized users, or by unauthorized external entities that
have compromised information system accounts, is a serious and ongoing concern
and can have significant adverse impacts on organizations. Auditing the use of
privileged functions is one way to detect such misuse and identify the risk
from insider threats and the advanced persistent threat.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-002234</ident>
      <fixtext>At the command line, execute the following command to obtain a list of
setuid files:

    # find / -xdev -perm -4000 -type f -o -perm -2000 -type f | sort

    Execute the following for each setuid file found in the first command that
does not have a corresponding line in the audit rules:

    Navigate to and open:

    /etc/audit/rules.d/audit.STIG.rules

    Add the following line:

    -a always,exit -F path=&lt;setuid_path&gt; -F perm=x -F auid&gt;=1000 -F
auid!=4294967295 -F key=privileged

    Execute the following command to load the new audit rules:

    # /sbin/augenrules --load

    Note: An older audit.STIG.rules may exist if the file exists and references 
    older "GEN" SRG IDs. This file can be removed and replaced as necessary 
    with an updated one.</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command to obtain a list of
setuid files:

    # find / -xdev -perm -4000 -type f -o -perm -2000 -type f | sort

    Execute the following command for each setuid file found in the first
command:

    # auditctl -l | grep &lt;setuid_path&gt;

    Replace &lt;setuid_path&gt; with each path found in the first command.

    If each &lt;setuid_path&gt; does not have a corresponding line in the audit
rules, this is a finding.

    A typical corresponding line will look like the below:

    -a always,exit -F path=&lt;setuid_path&gt; -F perm=x -F auid&gt;=1000 -F
auid!=4294967295 -F key=privileged

    Note: This check depends on the auditd service to be in a running state for 
    accurate results. Enabling the auditd service is done in control PHTN-30-000013.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000055">
    <title>SRG-OS-000341-GPOS-00132</title>
    <Rule id="r_PHTN-30-000055" severity="medium">
      <version>PHTN-30-000055</version>
      <title>The Photon operating system must configure auditd to keep five rotated log files.</title>
      <description>&lt;VulnDiscussion&gt;Audit logs are most useful when accessible by date, rather than size.
This can be accomplished through a combination of an audit log rotation cron
job, setting a reasonable number of logs to keep and configuring auditd to not
rotate the logs on its own. This ensures that audit logs are accessible to the
ISSO in the event of a central log processing failure.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-001849</ident>
      <fixtext>Navigate to and open:

/etc/audit/auditd.conf

Add or change the "num_logs" line as follows:

num_logs = 5

At the command line, execute the following command(s):

# killproc auditd -TERM
# systemctl start auditd</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # grep "^num_logs" /etc/audit/auditd.conf

    Expected result:

    num_logs = 5

    If the output of the command does not match the expected result, this is a
finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000056">
    <title>SRG-OS-000341-GPOS-00132</title>
    <Rule id="r_PHTN-30-000056" severity="medium">
      <version>PHTN-30-000056</version>
      <title>The Photon operating system must configure auditd to keep logging in the event max log file size is reached.</title>
      <description>&lt;VulnDiscussion&gt;Audit logs are most useful when accessible by date, rather than size.
This can be accomplished through a combination of an audit log rotation cron
job, setting a reasonable number of logs to keep and configuring auditd to not
rotate the logs on its own. This ensures that audit logs are accessible to the
ISSO in the event of a central log processing failure.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-001849</ident>
      <fixtext>Navigate to and open:

/etc/audit/auditd.conf

Add or change the "max_log_file_action" line as follows:

max_log_file_action = IGNORE

At the command line, execute the following command(s):

# killproc auditd -TERM
# systemctl start auditd</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # grep "^max_log_file_action" /etc/audit/auditd.conf

    Expected result:

    max_log_file_action = IGNORE

    If the output of the command does not match the expected result, this is a
finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000057">
    <title>SRG-OS-000343-GPOS-00134</title>
    <Rule id="r_PHTN-30-000057" severity="medium">
      <version>PHTN-30-000057</version>
      <title>The Photon operating system must configure auditd to log space limit problems to syslog.</title>
      <description>&lt;VulnDiscussion&gt;If security personnel are not notified immediately when storage volume
reaches 75% utilization, they are unable to plan for audit record storage
capacity expansion.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-001855</ident>
      <fixtext>Navigate to and open:

/etc/audit/auditd.conf

Ensure that the "space_left" line is uncommented and set to the following:

space_left = 75

At the command line, execute the following command(s):

# killproc auditd -TERM
# systemctl start auditd</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# grep "^space_left " /etc/audit/auditd.conf

Expected result:

space_left = 75

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000058">
    <title>SRG-OS-000355-GPOS-00143</title>
    <Rule id="r_PHTN-30-000058" severity="medium">
      <version>PHTN-30-000058</version>
      <title>The Photon operating system must be configured to synchronize with an approved DoD time source.</title>
      <description>&lt;VulnDiscussion&gt;Inaccurate time stamps make it more difficult to correlate events and
can lead to an inaccurate analysis. Determining the correct time a particular
event occurred on a system is critical when conducting forensic analysis and
investigating system events. Sources outside the configured acceptable
allowance (drift) may be inaccurate.

    Synchronizing internal information system clocks provides uniformity of
time stamps for information systems with multiple system clocks and systems
connected over a network.

    Organizations should consider endpoints that may not have regular access to
the authoritative time server (e.g., mobile, teleworking, and tactical
endpoints).&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-001891</ident>
      <fixtext>Navigate to and open:

/etc/ntp.conf

Set its contents to the following:

tinker panic 0
restrict default kod nomodify notrap nopeer
restrict 127.0.0.1
restrict -6 ::1
driftfile /var/lib/ntp/drift/ntp.drift
server &lt;site-specific-time-source-IP&gt;

At the command line, execute the following command(s):

# chkconfig ntpd on
# systemctl start ntp.service</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # grep -E '^\s*(server|peer|multicastclient)' /etc/ntp.conf

    Confirm the servers and peers or multicastclient (as applicable) are local
or an authoritative U.S. DoD source.

    If no lines are returned or a non-local/non-authoritative time server is
used, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000059">
    <title>SRG-OS-000366-GPOS-00153</title>
    <Rule id="r_PHTN-30-000059" severity="medium">
      <version>PHTN-30-000059</version>
      <title>The Photon operating system RPM package management tool must cryptographically verify the authenticity of all software packages during installation.</title>
      <description>&lt;VulnDiscussion&gt;Installation of any non-trusted software, patches, service packs,
device drivers, or operating system components can significantly affect the
overall security of the operating system. Ensuring all packages' cryptographic
signatures are valid prior to installation ensures the provenance of the
software and protects against malicious tampering.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-001749</ident>
      <fixtext>Open the file containing "nosignature" with a text editor and
remove the option.</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# grep -s nosignature /usr/lib/rpm/rpmrc /etc/rpmrc ~root/.rpmrc

If the command returns any output, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000060">
    <title>SRG-OS-000366-GPOS-00153</title>
    <Rule id="r_PHTN-30-000060" severity="medium">
      <version>PHTN-30-000060</version>
      <title>The Photon operating system RPM package management tool must cryptographically verify the authenticity of all software packages during installation.</title>
      <description>&lt;VulnDiscussion&gt;Installation of any non-trusted software, patches, service packs,
device drivers, or operating system components can significantly affect the
overall security of the operating system. This requirement ensures the software
has not been tampered with and has been provided by a trusted vendor.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-001749</ident>
      <fixtext>Navigate to and open:

/etc/tdnf/tdnf.conf

Remove any existing "gpgcheck" setting and add the following line:

gpgcheck=1</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# grep "^gpgcheck" /etc/tdnf/tdnf.conf

If "gpgcheck" is not set to "1", this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000061">
    <title>SRG-OS-000366-GPOS-00153</title>
    <Rule id="r_PHTN-30-000061" severity="medium">
      <version>PHTN-30-000061</version>
      <title>The Photon operating system RPM package management tool must cryptographically verify the authenticity of all software packages during installation.</title>
      <description>&lt;VulnDiscussion&gt;Installation of any non-trusted software, patches, service packs,
device drivers, or operating system components can significantly affect the
overall security of the operating system. This requirement ensures the software
has not been tampered with and has been provided by a trusted vendor.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-001749</ident>
      <fixtext>Open the file where "gpgcheck" is not set to 1 with a text editor.

    Remove any existing "gpgcheck" setting and add the following line at the
end of the file:

    gpgcheck=1</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# grep gpgcheck /etc/yum.repos.d/*

If "gpgcheck" is not set to "1" in any returned file, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000062">
    <title>SRG-OS-000373-GPOS-00156</title>
    <Rule id="r_PHTN-30-000062" severity="medium">
      <version>PHTN-30-000062</version>
      <title>The Photon operating system must require users to reauthenticate for privilege escalation.</title>
      <description>&lt;VulnDiscussion&gt;Without reauthentication, users may access resources or perform tasks
for which they do not have authorization.

    When operating systems provide the capability to escalate a functional
capability, it is critical the user reauthenticate.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-002038</ident>
      <fixtext>Check the configuration of the "/etc/sudoers" and "/etc/sudoers.d/*"
files with the following command:

    # visudo

    OR

    # visudo -f /etc/sudoers.d/&lt;file name&gt;

    Remove any occurrences of "NOPASSWD" tags associated with user accounts
with a password hash.</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command(s):

    # grep -ihs nopasswd /etc/sudoers /etc/sudoers.d/*|grep -v "^#"|grep -v
"^%"|awk '{print $1}'

    # awk -F: '($2 != "x" &amp;&amp; $2 != "!") {print $1}' /etc/shadow

    If any account listed in the first output is also listed in the second
output and is not documented, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000064">
    <title>SRG-OS-000394-GPOS-00174</title>
    <Rule id="r_PHTN-30-000064" severity="high">
      <version>PHTN-30-000064</version>
      <title>The Photon operating system must configure sshd to use FIPS 140-2 ciphers.</title>
      <description>&lt;VulnDiscussion&gt;Privileged access contains control and configuration information and is 
  particularly sensitive, so additional protections are necessary. This is maintained
   by using cryptographic mechanisms such as encryption to protect confidentiality.

Nonlocal maintenance and diagnostic activities are those activities conducted by
 individuals communicating through a network, either an external network 
 (e.g., the Internet) or an internal network. Local maintenance and diagnostic
  activities are those activities carried out by individuals physically present
   at the information system or information system component and not communicating
    across a network connection. 

This requirement applies to hardware/software diagnostic test equipment or tools. 
This requirement does not cover hardware/software components that may support 
information system maintenance, yet are a part of the system (e.g., the software 
implementing "ping," "ls," "ipconfig," or the hardware and software implementing 
the monitoring port of an Ethernet switch).

The operating system can meet this requirement through leveraging a cryptographic module.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-003123</ident>
      <fixtext>Navigate to and open:

    /etc/ssh/sshd_config

    Ensure that the "Ciphers" line is uncommented and set to the
following:

    Ciphers aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr

    At the command line, execute the following command:

    # systemctl restart sshd.service</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # sshd -T|&amp;grep -i Ciphers

    Expected result:

    ciphers aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr

    If the output matches the ciphers in the expected result or a subset thereof, this is not a finding.

If the ciphers in the output contain any ciphers not listed in the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000065">
    <title>SRG-OS-000433-GPOS-00193</title>
    <Rule id="r_PHTN-30-000065" severity="medium">
      <version>PHTN-30-000065</version>
      <title>The Photon operating system must implement address space layout randomization (ASLR) to protect its memory from unauthorized code execution.</title>
      <description>&lt;VulnDiscussion&gt;ASLR makes it more difficult for an attacker to predict the location
of attack code he or she has introduced into a process's address space during
an attempt at exploitation.

    Additionally, ASLR also makes it more difficult for an attacker to know the
location of existing code in order to repurpose it using return-oriented
programming (ROP) techniques.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-002824</ident>
      <fixtext>Navigate to and open:

    /etc/sysctl.d/50-security-hardening.conf

    Ensure that the "randomize_va_space" is uncommented and set to the
following:

    kernel.randomize_va_space=2

    At the command line, execute the following command:

    # sysctl --system</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# cat /proc/sys/kernel/randomize_va_space

If the value of "randomize_va_space" is not "2", this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000066">
    <title>SRG-OS-000437-GPOS-00194</title>
    <Rule id="r_PHTN-30-000066" severity="medium">
      <version>PHTN-30-000066</version>
      <title>The Photon operating system must remove all software components after updated versions have been installed.</title>
      <description>&lt;VulnDiscussion&gt;Previous versions of software components that are not removed from the
information system after updates have been installed may be exploited by
adversaries. Some information technology products may remove older versions of
software automatically from the information system.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-002617</ident>
      <fixtext>Navigate to and open:

    /etc/tdnf/tdnf.conf

    Remove any existing "clean_requirements_on_remove" line and ensure the
following line is present:

    clean_requirements_on_remove=true</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# grep -i "^clean_requirements_on_remove" /etc/tdnf/tdnf.conf

Expected result:

clean_requirements_on_remove=true

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000067">
    <title>SRG-OS-000458-GPOS-00203</title>
    <Rule id="r_PHTN-30-000067" severity="medium">
      <version>PHTN-30-000067</version>
      <title>The Photon operating system must generate audit records when the sudo command is used.</title>
      <description>&lt;VulnDiscussion&gt;Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000172</ident>
      <fixtext>Navigate to and open:

    /etc/audit/rules.d/audit.STIG.rules

    Add the following line:

    -a always,exit -F path=/usr/bin/sudo -F perm=x -F auid&gt;=1000 -F
auid!=4294967295 -F key=privileged

    Execute the following command to load the new audit rules:

    # /sbin/augenrules --load

    Note: An older audit.STIG.rules may exist if the file exists and references 
    older "GEN" SRG IDs. This file can be removed and replaced as necessary 
    with an updated one.</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # auditctl -l | grep sudo

    Expected result:
    -a always,exit -F path=/usr/bin/sudo -F perm=x -F auid&gt;=1000 -F
auid!=4294967295 -k privileged

    If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000068">
    <title>SRG-OS-000470-GPOS-00214</title>
    <Rule id="r_PHTN-30-000068" severity="medium">
      <version>PHTN-30-000068</version>
      <title>The Photon operating system must generate audit records when successful/unsuccessful logon attempts occur.</title>
      <description>&lt;VulnDiscussion&gt;Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000172</ident>
      <fixtext>Navigate to and open:

/etc/audit/rules.d/audit.STIG.rules

Add the following lines:

-w /var/log/faillog -p wa
-w /var/log/lastlog -p wa
-w /var/log/tallylog -p wa

Execute the following command to load the new audit rules:

# /sbin/augenrules --load

Note: An older audit.STIG.rules may exist if the file exists and references 
older "GEN" SRG IDs. This file can be removed and replaced as necessary 
with an updated one.</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# auditctl -l | grep -E "faillog|lastlog|tallylog"

Expected result:

-w /var/log/faillog -p wa
-w /var/log/lastlog -p wa
-w /var/log/tallylog -p wa

If the output does not match the expected result, this is a finding.

Note: This check depends on the auditd service to be in a running state for 
accurate results. Enabling the auditd service is done in control PHTN-30-000013.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000069">
    <title>SRG-OS-000471-GPOS-00216</title>
    <Rule id="r_PHTN-30-000069" severity="medium">
      <version>PHTN-30-000069</version>
      <title>The Photon operating system must audit the insmod module.</title>
      <description>&lt;VulnDiscussion&gt;Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000172</ident>
      <fixtext>Navigate to and open:

/etc/audit/rules.d/audit.STIG.rules

Add the following lines:

-w /sbin/insmod -p x

Execute the following command to load the new audit rules:

# /sbin/augenrules --load

Note: An older audit.STIG.rules may exist if the file exists and references 
older "GEN" SRG IDs. This file can be removed and replaced as necessary 
with an updated one.</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# auditctl -l | grep "/sbin/insmod"

Expected result:

-w /sbin/insmod -p x

If the output does not match the expected result, this is a finding.

Note: This check depends on the auditd service to be in a running state for 
accurate results. Enabling the auditd service is done in control PHTN-30-000013.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000070">
    <title>SRG-OS-000476-GPOS-00221</title>
    <Rule id="r_PHTN-30-000070" severity="medium">
      <version>PHTN-30-000070</version>
      <title>The Photon operating system auditd service must generate audit records for all account creations, modifications, disabling, and termination events.</title>
      <description>&lt;VulnDiscussion&gt;Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000172</ident>
      <fixtext>Navigate to and open:

/etc/audit/rules.d/audit.STIG.rules

Add the following line:

-w /etc/security/opasswd -p wa -k opasswd

Execute the following command to load the new audit rules:

# /sbin/augenrules --load

Note: An older audit.STIG.rules may exist if the file exists and references 
older "GEN" SRG IDs. This file can be removed and replaced as necessary 
with an updated one.</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # auditctl -l | grep -E /etc/security/opasswd

    If any of these are not listed with a permissions filter of at least "w",
this is a finding.

    Note: This check depends on the auditd service to be in a running state for 
    accurate results. Enabling the auditd service is done in control PHTN-30-000013.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000071">
    <title>SRG-OS-000480-GPOS-00225</title>
    <Rule id="r_PHTN-30-000071" severity="medium">
      <version>PHTN-30-000071</version>
      <title>The Photon operating system must use the pam_cracklib module.</title>
      <description>&lt;VulnDiscussion&gt;If the operating system allows the user to select passwords based on
dictionary words, this increases the chances of password compromise by
increasing the opportunity for successful guesses and brute-force attacks.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>Navigate to and open:

    /etc/pam.d/system-password

    Add the following, replacing any existing "pam_cracklib.so" line :

    password requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1
ocredit=-1 minlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # grep pam_cracklib /etc/pam.d/system-password

    If the output does not return at least "password  requisite
pam_cracklib.so", this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000072">
    <title>SRG-OS-000480-GPOS-00226</title>
    <Rule id="r_PHTN-30-000072" severity="medium">
      <version>PHTN-30-000072</version>
      <title>The Photon operating system must set the FAIL_DELAY parameter.</title>
      <description>&lt;VulnDiscussion&gt;Limiting the number of logon attempts over a certain time interval
reduces the chances that an unauthorized user may gain access to an account.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>Navigate to and open:

/etc/login.defs

Add the following line after the last auth statement:

FAIL_DELAY 4</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# grep FAIL_DELAY /etc/login.defs

Expected result:

FAIL_DELAY 4

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000073">
    <title>SRG-OS-000480-GPOS-00226</title>
    <Rule id="r_PHTN-30-000073" severity="medium">
      <version>PHTN-30-000073</version>
      <title>The Photon operating system must enforce a delay of at least four seconds between logon prompts following a failed logon attempt.</title>
      <description>&lt;VulnDiscussion&gt;Limiting the number of logon attempts over a certain time interval
reduces the chances that an unauthorized user may gain access to an account.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>Navigate to and open:

    /etc/pam.d/system-auth

    Remove any existing "pam_faildelay" line and add the follwing line at the
end of the file:

    auth optional pam_faildelay.so delay=4000000</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# grep pam_faildelay /etc/pam.d/system-auth|grep --color=always "delay="

Expected result:

auth optional pam_faildelay.so delay=4000000

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000074">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000074" severity="medium">
      <version>PHTN-30-000074</version>
      <title>The Photon operating system must ensure audit events are flushed to disk at proper intervals.</title>
      <description>&lt;VulnDiscussion&gt;Without setting a balance between performance and ensuring all audit
events are written to disk, performance of the system may suffer or the risk of
missing audit entries may be too high.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>Navigate to and open:

    /etc/audit/auditd.conf

    Ensure that the below line is present and any existing "flush" and
"freq" settings are removed.

    flush = INCREMENTAL_ASYNC
    freq = 50</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# grep -E "freq|flush" /etc/audit/auditd.conf

Expected result:

flush = INCREMENTAL_ASYNC
freq = 50

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000075">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000075" severity="medium">
      <version>PHTN-30-000075</version>
      <title>The Photon operating system must create a home directory for all new local interactive user accounts.</title>
      <description>&lt;VulnDiscussion&gt;If local interactive users are not assigned a valid home directory,
there is no place for the storage and control of files they should own.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>Navigate to and open:

    /etc/login.defs

    Ensure that the following is present and any exising CREATE_HOME line is
removed:

    CREATE_HOME     yes</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # grep -i "^create_home" /etc/login.defs

    If there is no output or the output does not equal "CREATE_HOME     yes",
this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000076">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000076" severity="medium">
      <version>PHTN-30-000076</version>
      <title>The Photon operating system must disable the debug-shell service.</title>
      <description>&lt;VulnDiscussion&gt;The debug-shell service is intended to diagnose systemd related boot
issues with various systemctl commands. Once enabled and following a system
reboot, the root shell will be available on tty9. This service must remain
disabled until and unless otherwise directed by VMware support.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>At the command line, execute the following command(s):

# systemctl stop debug-shell.service
# systemctl disable debug-shell.service

Reboot for changes to take effect.</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# systemctl status debug-shell.service|grep -E --color=always disabled

If the debug-shell service is not disabled, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000077">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000077" severity="medium">
      <version>PHTN-30-000077</version>
      <title>The Photon operating system must configure a secure umask for all shells.</title>
      <description>&lt;VulnDiscussion&gt;A user's umask influences the permissions assigned to files that a
user creates. Setting an appropriate umask is important to make sure that
information is not exposed to unprivileged users.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>Navigate to and open:

/etc/profile.d/umask.sh

Set the contents as follows:

# By default, the umask should be set.
if [ "$(id -gn)" = "$(id -un)" -a $EUID -gt 99 ] ; then
  umask 002
else
  umask 027
fi</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# cat /etc/profile.d/umask.sh

Expected result:

# By default, the umask should be set.
if [ "$(id -gn)" = "$(id -un)" -a $EUID -gt 99 ] ; then
  umask 002
else
  umask 027
fi

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000078">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000078" severity="medium">
      <version>PHTN-30-000078</version>
      <title>The Photon operating system must configure sshd to disallow Generic Security Service Application Program Interface (GSSAPI) authentication.</title>
      <description>&lt;VulnDiscussion&gt;GSSAPI authentication is used to provide additional authentication
mechanisms to applications. Allowing GSSAPI authentication through SSH exposes
the systems GSSAPI to remote hosts, increasing the attack surface of the
system.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>Navigate to and open:

    /etc/ssh/sshd_config

    Ensure that the "GSSAPIAuthentication" line is uncommented and set to the
following:

    GSSAPIAuthentication no

    At the command line, execute the following command:

    # systemctl restart sshd.service</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# sshd -T|&amp;grep -i GSSAPIAuthentication

Expected result:

GSSAPIAuthentication no

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000079">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000079" severity="medium">
      <version>PHTN-30-000079</version>
      <title>The Photon operating system must configure sshd to disable environment processing.</title>
      <description>&lt;VulnDiscussion&gt;Enabling environment processing may enable users to bypass access
restrictions in some configurations and must therefore be disabled.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>Navigate to and open:

    /etc/ssh/sshd_config

    Ensure that the "PermitUserEnvironment" line is uncommented and set to
the following:

    PermitUserEnvironment no

    At the command line, execute the following command:

    # systemctl restart sshd.service</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

sshd -T|&amp;grep -i PermitUserEnvironment

Expected result:

PermitUserEnvironment no

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000080">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000080" severity="medium">
      <version>PHTN-30-000080</version>
      <title>The Photon operating system must configure sshd to disable X11 forwarding.</title>
      <description>&lt;VulnDiscussion&gt;X11 is an older, insecure graphics forwarding protocol. It is not used
by Photon and should be disabled as a general best practice to limit attack
surface area and communication channels.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>Navigate to and open:

    /etc/ssh/sshd_config

    Ensure that the "X11Forwarding" line is uncommented and set to the
following:

    X11Forwarding no

    At the command line, execute the following command:

    # systemctl restart sshd.service</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# sshd -T|&amp;grep -i X11Forwarding

Expected result:

X11Forwarding no

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000081">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000081" severity="medium">
      <version>PHTN-30-000081</version>
      <title>The Photon operating system must configure sshd to perform strict mode checking of home directory configuration files.</title>
      <description>&lt;VulnDiscussion&gt;If other users have access to modify user-specific SSH configuration
files, they may be able to log on to the system as another user.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>Navigate to and open:

    /etc/ssh/sshd_config

    Ensure that the "StrictModes" line is uncommented and set to the
following:

    StrictModes yes

    At the command line, execute the following command:

    # systemctl restart sshd.service</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# sshd -T|&amp;grep -i StrictModes

Expected result:

StrictModes yes

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000082">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000082" severity="medium">
      <version>PHTN-30-000082</version>
      <title>The Photon operating system must configure sshd to disallow Kerberos authentication.</title>
      <description>&lt;VulnDiscussion&gt;If Kerberos is enabled through SSH, sshd provides a means of access to
the system's Kerberos implementation. Vulnerabilities in the system's Kerberos
implementation may then be subject to exploitation. To reduce the attack
surface of the system, the Kerberos authentication mechanism within SSH must be
disabled.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>Navigate to and open:

    /etc/ssh/sshd_config

    Ensure that the "KerberosAuthentication" line is uncommented and set to
the following:

    KerberosAuthentication no

    At the command line, execute the following command:

    # systemctl restart sshd.service</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# sshd -T|&amp;grep -i KerberosAuthentication

Expected result:

KerberosAuthentication no

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000083">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000083" severity="medium">
      <version>PHTN-30-000083</version>
      <title>The Photon operating system must configure sshd to disallow authentication with an empty password.</title>
      <description>&lt;VulnDiscussion&gt;Blank passwords are one of the first things an attacker checks for
when probing a system. Even is the user somehow has a blank password on the OS,
sshd must not allow that user to log in.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>Navigate to and open:

    /etc/ssh/sshd_config

    Ensure that the "PermitEmptyPasswords" line is uncommented and set to the
following:

    PermitEmptyPasswords no

    At the command line, execute the following command:

    # systemctl restart sshd.service</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# sshd -T|&amp;grep -i PermitEmptyPasswords

Expected result:

PermitEmptyPasswords no

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000084">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000084" severity="medium">
      <version>PHTN-30-000084</version>
      <title>The Photon operating system must configure sshd to disallow compression of the encrypted session stream.</title>
      <description>&lt;VulnDiscussion&gt;If compression is allowed in an SSH connection prior to
authentication, vulnerabilities in the compression software could result in
compromise of the system from an unauthenticated connection.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>Navigate to and open:

    /etc/ssh/sshd_config

    Ensure that the "Compression" line is uncommented and set to the
following:

    Compression no

    At the command line, execute the following command:

    # systemctl restart sshd.service</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# sshd -T|&amp;grep -i Compression

Expected result:

Compression no

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000085">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000085" severity="medium">
      <version>PHTN-30-000085</version>
      <title>The Photon operating system must configure sshd to display the last login immediately after authentication.</title>
      <description>&lt;VulnDiscussion&gt;Providing users with feedback on the alst time they logged on via SSH
facilitates user recognition and reporting of unauthorized account use.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>Navigate to and open:

    /etc/ssh/sshd_config

    Ensure that the "PrintLastLog" line is uncommented and set to the
following:

    PrintLastLog yes

    At the command line, execute the following command:

    # systemctl restart sshd.service</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# sshd -T|&amp;grep -i PrintLastLog

Expected result:

PrintLastLog yes

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000086">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000086" severity="medium">
      <version>PHTN-30-000086</version>
      <title>The Photon operating system must configure sshd to ignore user-specific trusted hosts lists.</title>
      <description>&lt;VulnDiscussion&gt;SSH trust relationships enable trivial lateral spread after a host
compromise and therefore must be explicitly disabled. Individual users can have
a local list of trusted remote machines, which must also be ignored while
disabling host-based authentication generally.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>Navigate to and open:

    /etc/ssh/sshd_config

    Ensure that the "IgnoreRhosts" line is uncommented and set to the
following:

    IgnoreRhosts yes

    At the command line, execute the following command:

    # systemctl restart sshd.service</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# sshd -T|&amp;grep -i IgnoreRhosts

Expected result:

IgnoreRhosts yes

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000087">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000087" severity="medium">
      <version>PHTN-30-000087</version>
      <title>The Photon operating system must configure sshd to ignore user-specific known_host files.</title>
      <description>&lt;VulnDiscussion&gt;SSH trust relationships enable trivial lateral spread after a host
compromise and therefore must be explicitly disabled. Individual users can have
a local list of trusted remote machines which must also be ignored while
disabling host-based authentication generally.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>Navigate to and open:

    /etc/ssh/sshd_config

    Ensure that the "IgnoreUserKnownHosts" line is uncommented and set to the
following:

    IgnoreUserKnownHosts yes

    At the command line, execute the following command:

    # systemctl restart sshd.service</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# sshd -T|&amp;grep -i IgnoreUserKnownHosts

Expected result:

IgnoreUserKnownHosts yes

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000088">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000088" severity="medium">
      <version>PHTN-30-000088</version>
      <title>The Photon operating system must configure sshd to limit the number of allowed login attempts per connection.</title>
      <description>&lt;VulnDiscussion&gt;By setting the login attempt limit to a low value, an attacker will be
forced to reconnect frequently, which severely limits the speed and
effectiveness of brute-force attacks.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>Navigate to and open:

    /etc/ssh/sshd_config

    Ensure that the "MaxAuthTries" line is uncommented and set to the
following:

    MaxAuthTries 6

    At the command line, execute the following command:

    # systemctl restart sshd.service</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# sshd -T|&amp;grep -i MaxAuthTries

Expected result:

MaxAuthTries 6

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000089">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000089" severity="medium">
      <version>PHTN-30-000089</version>
      <title>The Photon operating system must be configured so that the x86 Ctrl-Alt-Delete key sequence is disabled on the command line.</title>
      <description>&lt;VulnDiscussion&gt;When the Ctrl-Alt-Del target is enabled, a locally logged-on user who
presses Ctrl-Alt-Delete, when at the console, can reboot the system. If
accidentally pressed, as could happen in the case of a mixed OS environment,
this can create the risk of short-term loss of systems availability due to
unintentional reboot.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>At the command line, execute the following command:

# systemctl mask ctrl-alt-del.target</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# systemctl status ctrl-alt-del.target

Expected result:

ctrl-alt-del.target
Loaded: masked (/dev/null; bad)
Active: inactive (dead)

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000090">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000090" severity="medium">
      <version>PHTN-30-000090</version>
      <title>The Photon operating system must be configured so that the /etc/skel default scripts are protected from unauthorized modification.</title>
      <description>&lt;VulnDiscussion&gt;If the skeleton files are not protected, unauthorized personnel could
change user startup parameters and possibly jeopardize user files.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>At the command line, execute the following command(s):

# chmod 750 /etc/skel/.bash_logout
# chmod 644 /etc/skel/.bash_profile
# chmod 750 /etc/skel/.bashrc
# chown root:root /etc/skel/.bash_logout
# chown root:root /etc/skel/.bash_profile
# chown root:root /etc/skel/.bashrc</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# stat -c "%n permissions are %a and owned by %U:%G" /etc/skel/.[^.]*

Expected result:

/etc/skel/.bash_logout permissions are 750 and owned by root:root
/etc/skel/.bash_profile permissions are 644 and owned by root:root
/etc/skel/.bashrc permissions are 750 and owned by root:root

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000091">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000091" severity="medium">
      <version>PHTN-30-000091</version>
      <title>The Photon operating system must be configured so that the /root path is protected from unauthorized access.</title>
      <description>&lt;VulnDiscussion&gt;If the /root path is accessible from users other than root,
unauthorized users could change the root partitions files.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>At the command line, execute the following command(s):

# chmod 700 /root
# chown root:root /root</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# stat -c "%n permissions are %a and owned by %U:%G" /root

Expected result:

/root permissions are 700 and owned by root:root

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000092">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000092" severity="medium">
      <version>PHTN-30-000092</version>
      <title>The Photon operating system must be configured so that all global initialization scripts are protected from unauthorized modification.</title>
      <description>&lt;VulnDiscussion&gt;Local initialization files are used to configure the user's shell
environment upon login. Malicious modification of these files could compromise
accounts upon login.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>At the command line, execute the following commands for each returned file:

# chmod o-w &lt;file&gt;
# chown root:root &lt;file&gt;</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # find /etc/bash.bashrc /etc/profile /etc/profile.d/ -xdev -type f -a '('
-perm -002 -o -not -user root -o -not -group root ')' -exec ls -ld {} \;

    If any files are returned, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000093">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000093" severity="medium">
      <version>PHTN-30-000093</version>
      <title>The Photon operating system must be configured so that all system startup scripts are protected from unauthorized modification.</title>
      <description>&lt;VulnDiscussion&gt;If system startup scripts are accessible to unauthorized modification,
this could compromise the system on startup.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>At the command line, execute the following commands for each returned file:

# chmod o-w &lt;file&gt;
# chown root:root &lt;file&gt;</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # find /etc/rc.d/* -xdev -type f -a '(' -perm -002 -o -not -user root -o
-not -group root ')' -exec ls -ld {} \;

    If any files are returned, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000094">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000094" severity="medium">
      <version>PHTN-30-000094</version>
      <title>The Photon operating system must be configured so that all files have a valid owner and group owner.</title>
      <description>&lt;VulnDiscussion&gt;If files do not have valid user and group owners, unintended access to
files could occur.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>At the command line, execute the following command for each returned file:

# chown root:root &lt;file&gt;</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# find / -fstype ext4 -nouser -o -nogroup -exec ls -ld {} \; 2&gt;/dev/null

If any files are returned, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000095">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000095" severity="medium">
      <version>PHTN-30-000095</version>
      <title>The Photon operating system must be configured so that the /etc/cron.allow file is protected from unauthorized modification.</title>
      <description>&lt;VulnDiscussion&gt;If cron files and folders are accessible to unauthorized users,
malicious jobs may be created.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>At the command line, execute the following command(s):

# chmod 600 /etc/cron.allow
# chown root:root /etc/cron.allow</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# stat -c "%n permissions are %a and owned by %U:%G" /etc/cron.allow

Expected result:

/etc/cron.allow permissions are 600 and owned by root:root

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000096">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000096" severity="medium">
      <version>PHTN-30-000096</version>
      <title>The Photon operating system must be configured so that all cron jobs are protected from unauthorized modification.</title>
      <description>&lt;VulnDiscussion&gt;If cron files and folders are accessible to unauthorized users,
malicious jobs may be created.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>At the command line, execute the following command(s) for each returned
file:

    # chmod o-w &lt;file&gt;
    # chown root:root &lt;file&gt;</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # find /etc/cron.d/ /etc/cron.daily/ /etc/cron.hourly/ /etc/cron.monthly/
/etc/cron.weekly/ -xdev -type f -a '(' -perm -002 -o -not -user root -o -not
-group root ')' -exec ls -ld {} \;

    If any files are returned, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000097">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000097" severity="medium">
      <version>PHTN-30-000097</version>
      <title>The Photon operating system must be configured so that all cron paths are protected from unauthorized modification.</title>
      <description>&lt;VulnDiscussion&gt;If cron files and folders are accessible to unauthorized users,
malicious jobs may be created.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>At the command line, execute the following command(s) for each returned
file:

    # chmod 755 &lt;path&gt;
    # chown root:root &lt;path&gt;</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # stat -c "%n permissions are %a and owned by %U:%G" /etc/cron.d
/etc/cron.daily /etc/cron.hourly /etc/cron.monthly /etc/cron.weekly

    Expected result:

    /etc/cron.d permissions are 755 and owned by root:root
    /etc/cron.daily permissions are 755 and owned by root:root
    /etc/cron.hourly permissions are 755 and owned by root:root
    /etc/cron.monthly permissions are 755 and owned by root:root
    /etc/cron.weekly permissions are 755 and owned by root:root

    If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000098">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000098" severity="medium">
      <version>PHTN-30-000098</version>
      <title>The Photon operating system must not forward IPv4 or IPv6 source-routed packets.</title>
      <description>&lt;VulnDiscussion&gt;Source routing is an Internet Protocol mechanism that allows an IP
packet to carry information, a list of addresses, that tells a router the path
the packet must take. There is also an option to record the hops as the route
is traversed.

    The list of hops taken, the "route record", provides the destination with
a return path to the source. This allows the source (the sending host) to
specify the route, loosely or strictly, ignoring the routing tables of some or
all of the routers. It can allow a user to redirect network traffic for
malicious purposes and should therefore be disabled.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>At the command line, execute the following command:

    # for SETTING in $(/sbin/sysctl -aN --pattern
"net.ipv[4|6].conf.(all|default|eth.*).accept_source_route"); do sed -i -e
"/^${SETTING}/d" /etc/sysctl.conf;echo $SETTING=0&gt;&gt;/etc/sysctl.conf; done
    # /sbin/sysctl --load</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # /sbin/sysctl -a --pattern
"net.ipv[4|6].conf.(all|default|eth.*).accept_source_route"

    Expected result:

    net.ipv4.conf.all.accept_source_route = 0
    net.ipv4.conf.default.accept_source_route = 0
    net.ipv4.conf.eth0.accept_source_route = 0
    net.ipv6.conf.all.accept_source_route = 0
    net.ipv6.conf.default.accept_source_route = 0
    net.ipv6.conf.eth0.accept_source_route = 0

    If the output does not match the expected result, this is a finding.

    Note: The number of "ethx" lines returned is dependant on the number of
interfaces. Every "ethx" entry must be set to "0".</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000099">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000099" severity="medium">
      <version>PHTN-30-000099</version>
      <title>The Photon operating system must not respond to IPv4 Internet Control Message Protocol (ICMP) echoes sent to a broadcast address.</title>
      <description>&lt;VulnDiscussion&gt;Responding to broadcast (ICMP) echoes facilitates network mapping and
provides a vector for amplification attacks.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>At the command line, execute the following command(s):

# sed -i -e "/^net.ipv4.icmp_echo_ignore_broadcasts/d" /etc/sysctl.conf
# echo net.ipv4.icmp_echo_ignore_broadcasts=1&gt;&gt;/etc/sysctl.conf
# /sbin/sysctl --load</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# /sbin/sysctl -a --pattern ignore_broadcasts

Expected result:

net.ipv4.icmp_echo_ignore_broadcasts = 1

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000100">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000100" severity="medium">
      <version>PHTN-30-000100</version>
      <title>The Photon operating system must prevent IPv4 Internet Control Message Protocol (ICMP) redirect messages from being accepted.</title>
      <description>&lt;VulnDiscussion&gt;ICMP redirect messages are used by routers to inform hosts that a more
direct route exists for a particular destination. These messages modify the
host's route table and are unauthenticated. An illicit ICMP redirect message
could result in a man-in-the-middle attack.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>At the command line, execute the following command:

    # for SETTING in $(/sbin/sysctl -aN --pattern
"net.ipv4.conf.(all|default|eth.*).accept_redirects"); do sed -i -e
"/^${SETTING}/d" /etc/sysctl.conf;echo $SETTING=0&gt;&gt;/etc/sysctl.conf; done
    # /sbin/sysctl --load</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # /sbin/sysctl -a --pattern
"net.ipv4.conf.(all|default|eth.*).accept_redirects"

    Expected result:

    net.ipv4.conf.all.accept_redirects = 0
    net.ipv4.conf.default.accept_redirects = 0
    net.ipv4.conf.eth0.accept_redirects = 0

    If the output does not match the expected result, this is a finding.

    Note: The number of "ethx" lines returned is dependant on the number of
interfaces. Every "ethx" entry must be set to "0".</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000101">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000101" severity="medium">
      <version>PHTN-30-000101</version>
      <title>The Photon operating system must prevent IPv4 Internet Control Message Protocol (ICMP) secure redirect messages from being accepted.</title>
      <description>&lt;VulnDiscussion&gt;ICMP redirect messages are used by routers to inform hosts that a more
direct route exists for a particular destination. These messages modify the
host's route table and are unauthenticated. An illicit ICMP redirect message
could result in a man-in-the-middle attack.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>At the command line, execute the following command:

    # for SETTING in $(/sbin/sysctl -aN --pattern
"net.ipv4.conf.(all|default|eth.*).secure_redirects"); do sed -i -e
"/^${SETTING}/d" /etc/sysctl.conf;echo $SETTING=0&gt;&gt;/etc/sysctl.conf; done
    # /sbin/sysctl --load</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # /sbin/sysctl -a --pattern
"net.ipv4.conf.(all|default|eth.*).secure_redirects"

    Expected result:

    net.ipv4.conf.all.secure_redirects = 0
    net.ipv4.conf.default.secure_redirects = 0
    net.ipv4.conf.eth0.secure_redirects = 0

    If the output does not match the expected result, this is a finding.

    Note: The number of "ethx" lines returned is dependant on the number of
interfaces. Every "ethx" entry must be set to "0".</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000102">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000102" severity="medium">
      <version>PHTN-30-000102</version>
      <title>The Photon operating system must not send IPv4 Internet Control Message Protocol (ICMP) redirects.</title>
      <description>&lt;VulnDiscussion&gt;ICMP redirect messages are used by routers to inform hosts that a more
direct route exists for a particular destination. These messages contain
information from the system's route table, possibly revealing portions of the
network topology.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>At the command line, execute the following command:

    # for SETTING in $(/sbin/sysctl -aN --pattern
"net.ipv4.conf.(all|default|eth.*).send_redirects"); do sed -i -e
"/^${SETTING}/d" /etc/sysctl.conf;echo $SETTING=0&gt;&gt;/etc/sysctl.conf; done
    # /sbin/sysctl --load</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # /sbin/sysctl -a --pattern
"net.ipv4.conf.(all|default|eth.*).send_redirects"

    Expected result:

    net.ipv4.conf.all.send_redirects = 0
    net.ipv4.conf.default.send_redirects = 0
    net.ipv4.conf.eth0.send_redirects = 0

    If the output does not match the expected result, this is a finding.

    Note: The number of "ethx" lines returned is dependant on the number of
interfaces. Every "ethx" entry must be set to "0".</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000103">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000103" severity="medium">
      <version>PHTN-30-000103</version>
      <title>The Photon operating system must log IPv4 packets with impossible addresses.</title>
      <description>&lt;VulnDiscussion&gt;The presence of "martian" packets (which have impossible addresses)
as well as spoofed packets, source-routed packets, and redirects could be a
sign of nefarious network activity. Logging these packets enables this activity
to be detected.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>At the command line, execute the following command:

    # for SETTING in $(/sbin/sysctl -aN --pattern
"net.ipv4.conf.(all|default|eth.*).log_martians"); do sed -i -e
"/^${SETTING}/d" /etc/sysctl.conf;echo $SETTING=1&gt;&gt;/etc/sysctl.conf; done
    # /sbin/sysctl --load</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # /sbin/sysctl -a --pattern
"net.ipv4.conf.(all|default|eth.*).log_martians"

    Expected result:

    net.ipv4.conf.all.log_martians = 1
    net.ipv4.conf.default.log_martians = 1
    net.ipv4.conf.eth0.log_martians = 1

    If the output does not match the expected result, this is a finding.

    Note: The number of "ethx" lines returned is dependant on the number of
interfaces. Every "ethx" entry must be set to "1".</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000104">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000104" severity="medium">
      <version>PHTN-30-000104</version>
      <title>The Photon operating system must use a reverse-path filter for IPv4 network traffic.</title>
      <description>&lt;VulnDiscussion&gt;Enabling reverse path filtering drops packets with source addresses
that should not have been able to be received on the interface they were
received on. It should not be used on systems that are routers for complicated
networks but is helpful for end hosts and routers serving small networks.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>At the command line, execute the following command:

    # for SETTING in $(/sbin/sysctl -aN --pattern
"net.ipv4.conf.(all|default|eth.*)\.rp_filter"); do sed -i -e
"/^${SETTING}/d" /etc/sysctl.conf;echo $SETTING=1&gt;&gt;/etc/sysctl.conf; done
    # /sbin/sysctl --load</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # /sbin/sysctl -a --pattern
"net.ipv4.conf.(all|default|eth.*)\.rp_filter"

    Expected result:

    net.ipv4.conf.all.rp_filter = 1
    net.ipv4.conf.default.rp_filter = 1
    net.ipv4.conf.eth0.rp_filter = 1

    If the output does not match the expected result, this is a finding.

    Note: The number of "ethx" lines returned is dependant on the number of
interfaces. Every "ethx" entry must be set to "1".</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000105">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000105" severity="medium">
      <version>PHTN-30-000105</version>
      <title>The Photon operating system must not perform multicast packet forwarding.</title>
      <description>&lt;VulnDiscussion&gt;Routing protocol daemons are typically used on routers to exchange
network topology information with other routers. If this software is used when
not required, system network information may be unnecessarily transmitted
across the network.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>At the command line, execute the following command:

    # for SETTING in $(/sbin/sysctl -aN --pattern
"net.ipv[4|6].conf.(all|default|eth.*).mc_forwarding"); do sed -i -e
"/^${SETTING}/d" /etc/sysctl.conf;echo $SETTING=0&gt;&gt;/etc/sysctl.conf; done
    # /sbin/sysctl --load</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # /sbin/sysctl -a --pattern
"net.ipv[4|6].conf.(all|default|eth.*).mc_forwarding"

    Expected result:

    net.ipv4.conf.all.mc_forwarding = 0
    net.ipv4.conf.default.mc_forwarding = 0
    net.ipv4.conf.eth0.mc_forwarding = 0
    net.ipv6.conf.all.mc_forwarding = 0
    net.ipv6.conf.default.mc_forwarding = 0
    net.ipv6.conf.eth0.mc_forwarding = 0

    If the output does not match the expected result, this is a finding.

    Note: The number of "ethx" lines returned is dependant on the number of
interfaces. Every "ethx" entry must be set to "0".</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000106">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000106" severity="medium">
      <version>PHTN-30-000106</version>
      <title>The Photon operating system must not perform IPv4 packet forwarding.</title>
      <description>&lt;VulnDiscussion&gt;Routing protocol daemons are typically used on routers to exchange
network topology information with other routers. If this software is used when
not required, system network information may be unnecessarily transmitted
across the network.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>At the command line, execute the following command(s):

# sed -i -e "/^net.ipv4.ip_forward/d" /etc/sysctl.conf
# echo net.ipv4.ip_forward=0&gt;&gt;/etc/sysctl.conf
# /sbin/sysctl --load</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# /sbin/sysctl -a --pattern "net.ipv4.ip_forward$"

Expected result:

net.ipv4.ip_forward = 0

If the system is intended to operate as a router, this is N/A.

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000107">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000107" severity="medium">
      <version>PHTN-30-000107</version>
      <title>The Photon operating system must send TCP timestamps.</title>
      <description>&lt;VulnDiscussion&gt;TCP timestamps are used to provide protection against wrapped sequence
numbers. It is possible to calculate system uptime (and boot time) by analyzing
TCP timestamps. These calculated uptimes can help a bad actor in determining
likely patch levels for vulnerabilities.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>At the command line, execute the following command(s):

# sed -i -e "/^net.ipv4.tcp_timestamps/d" /etc/sysctl.conf
# echo net.ipv4.tcp_timestamps=1&gt;&gt;/etc/sysctl.conf
# /sbin/sysctl --load</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# /sbin/sysctl -a --pattern "net.ipv4.tcp_timestamps$"

Expected result:

net.ipv4.tcp_timestamps = 1

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000108">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000108" severity="medium">
      <version>PHTN-30-000108</version>
      <title>The Photon operating system must be configured to protect the SSH public host key from unauthorized modification.</title>
      <description>&lt;VulnDiscussion&gt;If a public host key file is modified by an unauthorized user, the SSH
service may be compromised.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>At the command line, execute the following command(s) for each returned
file:

    # chmod 644 &lt;file&gt;
    # chown root:root &lt;file&gt;</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# stat -c "%n permissions are %a and owned by %U:%G" /etc/ssh/*key.pub

Expected result:

/etc/ssh/ssh_host_dsa_key.pub permissions are 644 and owned by root:root
/etc/ssh/ssh_host_ecdsa_key.pub permissions are 644 and owned by root:root
/etc/ssh/ssh_host_ed25519_key.pub permissions are 644 and owned by root:root
/etc/ssh/ssh_host_rsa_key.pub permissions are 644 and owned by root:root

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000109">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000109" severity="medium">
      <version>PHTN-30-000109</version>
      <title>The Photon operating system must be configured to protect the SSH private host key from unauthorized access.</title>
      <description>&lt;VulnDiscussion&gt;If an unauthorized user obtains the private SSH host key file, the
host could be impersonated.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>At the command line, execute the following command(s) for each returned
file:

    # chmod 600 &lt;file&gt;
    # chown root:root &lt;file&gt;</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# stat -c "%n permissions are %a and owned by %U:%G" /etc/ssh/*key

Expected result:

/etc/ssh/ssh_host_dsa_key permissions are 600 and owned by root:root
/etc/ssh/ssh_host_ecdsa_key permissions are 600 and owned by root:root
/etc/ssh/ssh_host_ed25519_key permissions are 600 and owned by root:root
/etc/ssh/ssh_host_rsa_key permissions are 600 and owned by root:root

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000110">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000110" severity="medium">
      <version>PHTN-30-000110</version>
      <title>The Photon operating system must enforce password complexity on the root account.</title>
      <description>&lt;VulnDiscussion&gt;Password complexity rules must apply to all accounts on the system,
including root. Without specifying the enforce_for_root flag, pam_cracklib does
not apply complexity rules to the root user. While root users can find ways
around this requirement, given its superuser power, it is necessary to attempt
to force compliance.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>Navigate to and open:

    /etc/pam.d/system-password

    Add the following, replacing any existing "pam_cracklib.so" line :

    password requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1
ocredit=-1 minlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # grep pam_cracklib /etc/pam.d/system-password|grep --color=always
"enforce_for_root"

    Expected result:

    password requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1
ocredit=-1 minlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root

    If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000111">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000111" severity="medium">
      <version>PHTN-30-000111</version>
      <title>The Photon operating system must protect all boot configuration files from unauthorized access.</title>
      <description>&lt;VulnDiscussion&gt;Boot configuration files control how the system boots, including
single-user mode, auditing, log levels, etc. Improper or malicious
configurations can negatively affect system security and availability.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>At the command line, execute the following command(s) for each returned
file:

    # chmod 600 &lt;file&gt;
    # chown root:root &lt;file&gt;</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # find /boot/*.cfg -xdev -type f -a '(' -not -perm 600 -o -not -user root
-o -not -group root ')' -exec ls -ld {} \;

    If any files are returned, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000112">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000112" severity="medium">
      <version>PHTN-30-000112</version>
      <title>The Photon operating system must protect sshd configuration from unauthorized access.</title>
      <description>&lt;VulnDiscussion&gt;The sshd_config file contains all the configuration items for sshd.
Incorrect or malicious configuration of sshd can allow unauthorized access to
the system, insecure communication, limited forensic trail, etc.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>At the command line, execute the following command(s):

# chmod 600 /etc/ssh/sshd_config
# chown root:root /etc/ssh/sshd_config</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# stat -c "%n permissions are %a and owned by %U:%G" /etc/ssh/sshd_config

Expected result:

/etc/ssh/sshd_config permissions are 600 and owned by root:root

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000113">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000113" severity="medium">
      <version>PHTN-30-000113</version>
      <title>The Photon operating system must protect all sysctl configuration files from unauthorized access.</title>
      <description>&lt;VulnDiscussion&gt;The sysctl configuration file specifes values for kernel parameters to
be set on boot. Incorrect or malicious configuration of these parameters can
have a negative effect on system security.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>At the command line, execute the following command(s) for each returned
file:

    # chmod 600 &lt;file&gt;
    # chown root:root &lt;file&gt;</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

    # find /etc/sysctl.conf /etc/sysctl.d/* -xdev -type f -a '(' -not -perm 600
-o -not -user root -o -not -group root ')' -exec ls -ld {} \;

    If any files are returned, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000114">
    <title>SRG-OS-000480-GPOS-00228</title>
    <Rule id="r_PHTN-30-000114" severity="medium">
      <version>PHTN-30-000114</version>
      <title>The Photon operating system must set the UMASK parameter correctly.</title>
      <description>&lt;VulnDiscussion&gt;The umask value influences the permissions assigned to files when they
are created. The umask setting in login.defs controls the permissions for a new
user's home directory. By setting the proper umask, home directories will only
allow the new user to read and write files there.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>Navigate to and open:

/etc/login.defs

Ensure that the "UMASK" line is uncommented and set to the following:

UMASK 077</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# grep UMASK /etc/login.defs

Expected result:

UMASK 077

If the output does not match the expected result, this a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000115">
    <title>SRG-OS-000480-GPOS-00229</title>
    <Rule id="r_PHTN-30-000115" severity="medium">
      <version>PHTN-30-000115</version>
      <title>The Photon operating system must configure sshd to disallow HostbasedAuthentication.</title>
      <description>&lt;VulnDiscussion&gt;SSH trust relationships enable trivial lateral spread after a host
compromise and therefore must be explicitly disabled.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>Navigate to and open:

    /etc/ssh/sshd_config

    Ensure that the "HostbasedAuthentication" line is uncommented and set to
the following:

    HostbasedAuthentication no

    At the command line, execute the following command:

    # systemctl restart sshd.service</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# sshd -T|&amp;grep -i HostbasedAuthentication

Expected result:

hostbasedauthentication no

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000117">
    <title>SRG-OS-000073-GPOS-00041</title>
    <Rule id="r_PHTN-30-000117" severity="medium">
      <version>PHTN-30-000117</version>
      <title>The Photon operating system must store only encrypted representations of passwords.</title>
      <description>&lt;VulnDiscussion&gt;Passwords must be protected at all times via strong, one way
encryption. If passwords are not encrypted, they can be plainly read (i.e.,
clear text) and easily compromised. If they are encrypted with a weak cipher,
those password are much more vulnerability to offline bute forcing attacks&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000196</ident>
      <fixtext>Navigate to and open:

/etc/pam.d/system-password

Add the argument "sha512" to the "password" line:

password required pam_unix.so sha512 shadow try_first_pass</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# grep password /etc/pam.d/system-password|grep --color=always "sha512"

If the output does not include "sha512", this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000118">
    <title>SRG-OS-000077-GPOS-00045</title>
    <Rule id="r_PHTN-30-000118" severity="medium">
      <version>PHTN-30-000118</version>
      <title>The Photon operating system must ensure that the old passwords are being stored.</title>
      <description>&lt;VulnDiscussion&gt;Password complexity, or strength, is a measure of the effectiveness of
a password in resisting attempts at guessing and brute-force attacks. If the
information system or application allows the user to consecutively reuse their
password when that password has exceeded its defined lifetime, the end result
is a password that is not changed as per policy requirements.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000200</ident>
      <fixtext>At the command line, execute the following command(s):

# touch /etc/security/opasswd
# chown root:root /etc/security/opasswd
# chmod 0600 /etc/security/opasswd</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# ls -al /etc/security/opasswd

If /etc/security/opasswd does not exist, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000119">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000119" severity="medium">
      <version>PHTN-30-000119</version>
      <title>The Photon operating system must configure sshd to restrict AllowTcpForwarding.</title>
      <description>&lt;VulnDiscussion&gt;While enabling TCP tunnels is a valuable function of sshd, this
feature is not appropriate for use on single purpose appliances.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>Navigate to and open:

    /etc/ssh/sshd_config

    Ensure that the "AllowTcpForwarding" line is uncommented and set to the
following:

    AllowTcpForwarding no

    At the command line, execute the following command:

    # systemctl restart sshd.service</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# sshd -T|&amp;grep -i AllowTcpForwarding

Expected result:

allowtcpforwarding no

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="PHTN-30-000120">
    <title>SRG-OS-000480-GPOS-00227</title>
    <Rule id="r_PHTN-30-000120" severity="medium">
      <version>PHTN-30-000120</version>
      <title>The Photon operating system must configure sshd to restrict LoginGraceTime.</title>
      <description>&lt;VulnDiscussion&gt;By default, sshd unauthenticated connections are left open for two
minutes before being closed. This setting is too permissive as no legitimate
login would need such an amount of time to complete a login. Quickly
terminating idle or incomplete login attempts will free up resources and reduce
the exposure any partial logon attempts may create.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <reference>
        <dc:publisher>VMware</dc:publisher>
        <dc:subject>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents.</dc:subject>
      </reference>
      <ident system="http://cyber.mil/cci">CCI-000366</ident>
      <fixtext>Navigate to and open:

    /etc/ssh/sshd_config

    Ensure that the "LoginGraceTime" line is uncommented and set to the
following:

    LoginGraceTime 30

    At the command line, execute the following command:

    # systemctl restart sshd.service</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# sshd -T|&amp;grep -i LoginGraceTime

Expected result:

logingracetime 30

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
</Benchmark>
