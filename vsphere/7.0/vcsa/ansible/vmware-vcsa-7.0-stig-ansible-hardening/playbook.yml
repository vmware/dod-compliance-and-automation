# This is the main playbook for launching the vSphere VCSA 7.0 STIG
- hosts: vcenter
  remote_user: root
  gather_facts: false
  # Sets up the vcenter for following role execution
  tasks:
    - name: Get Bash to be Default Terminal Part 1 of 2
      ansible.builtin.raw: shell.set --enabled true || true

    - name: Get Bash to be Default Terminal Part 2 of 2
      ansible.builtin.raw: shell command chsh -s /bin/bash root || true

    - name: Pausing for 120 Seconds
      ansible.builtin.pause:
        seconds: 120
  tags:
    - remote

- hosts: vcenter
  remote_user: root
  roles:
    - role: vmware-photon-3.0-stig-ansible-hardening
      vars:
        var_syslog_authpriv_log: '/var/log/audit/sshinfo.log'
        run_set_syslog_server: false
        run_set_ntp_server: false
    - role: eam
    - role: lookup
    - role: perfcharts
    - role: postgresql
    - role: rhttpproxy
    - role: sts
    - role: vami
    - role: ui
    - role: misc
  tags: 
    - remote
